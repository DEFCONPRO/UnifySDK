<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="840px" preserveAspectRatio="none" style="width:795px;height:840px;" version="1.1" viewBox="0 0 795 840" width="795px" zoomAndPan="magnify"><defs><filter height="300%" id="fbp3uo8ly1xe7" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFE0" height="828.1094" style="stroke:#A80036;stroke-width:1.0;" width="100" x="58" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94" x="61" y="18.0669">MQTT Broker</text><rect fill="#ADD8E6" height="828.1094" style="stroke:#A80036;stroke-width:1.0;" width="483.5" x="306" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="532.75" y="18.0669">ZPC</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="107.5" x2="107.5" y1="60.4297" y2="795.8125"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="403" x2="403" y1="60.4297" y2="795.8125"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="702.5" x2="702.5" y1="60.4297" y2="795.8125"/><rect fill="#FEFECE" filter="url(#fbp3uo8ly1xe7)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="55" x="78.5" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="85.5" y="45.1279">MQTT</text><rect fill="#FEFECE" filter="url(#fbp3uo8ly1xe7)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="55" x="78.5" y="794.8125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="85.5" y="814.8076">MQTT</text><rect fill="#FEFECE" filter="url(#fbp3uo8ly1xe7)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="183" x="310" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="169" x="317" y="45.1279">UclNetworkManagement</text><rect fill="#FEFECE" filter="url(#fbp3uo8ly1xe7)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="183" x="310" y="794.8125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="169" x="317" y="814.8076">UclNetworkManagement</text><rect fill="#FEFECE" filter="url(#fbp3uo8ly1xe7)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="162" x="619.5" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="148" x="626.5" y="45.1279">NetworkManagement</text><rect fill="#FEFECE" filter="url(#fbp3uo8ly1xe7)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="162" x="619.5" y="794.8125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="148" x="626.5" y="814.8076">NetworkManagement</text><path d="M24,75.4297 L24,100.4297 L188,100.4297 L188,85.4297 L178,75.4297 L24,75.4297 " fill="#FBFB77" filter="url(#fbp3uo8ly1xe7)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M178,75.4297 L178,85.4297 L188,85.4297 L178,75.4297 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="30" y="92.4966">User trigger Add Node</text><polygon fill="#A80036" points="391.5,172.0938,401.5,176.0938,391.5,180.0938,395.5,176.0938" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="108" x2="397.5" y1="176.0938" y2="176.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="153" x="115" y="125.6294">ucl/by-unid/&lt;gw-node&gt;/</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="118" x="115" y="140.7622">ProtocolController/</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="173" x="115" y="155.895">NetworkManagement/Write</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="115" y="171.0278">{"State": "add node", ...}</text><polygon fill="#A80036" points="690.5,201.2266,700.5,205.2266,690.5,209.2266,694.5,205.2266" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="403.5" x2="696.5" y1="205.2266" y2="205.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="270" x="410.5" y="200.1606">zwave_network_management_add_node()</text><polygon fill="#A80036" points="414.5,230.3594,404.5,234.3594,414.5,238.3594,410.5,234.3594" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="408.5" x2="701.5" y1="234.3594" y2="234.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="275" x="420.5" y="229.2935">on_state_updated(NM_WAITING_FOR_ADD)</text><polygon fill="#A80036" points="119,304.8906,109,308.8906,119,312.8906,115,308.8906" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="113" x2="402.5" y1="308.8906" y2="308.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="153" x="125" y="258.4263">ucl/by-unid/&lt;gw-node&gt;/</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="118" x="125" y="273.5591">ProtocolController/</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="137" x="125" y="288.6919">NetworkManagement</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="125" y="303.8247">{"State": "add node", ...}</text><polygon fill="#A80036" points="414.5,334.0234,404.5,338.0234,414.5,342.0234,410.5,338.0234" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="408.5" x2="701.5" y1="338.0234" y2="338.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124" x="420.5" y="332.9575">on_keys_reported()</text><polygon fill="#A80036" points="690.5,363.1563,700.5,367.1563,690.5,371.1563,694.5,367.1563" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="403.5" x2="696.5" y1="367.1563" y2="367.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="263" x="410.5" y="362.0903">zwave_network_management_keys_set()</text><polygon fill="#A80036" points="414.5,392.2891,404.5,396.2891,414.5,400.2891,410.5,396.2891" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="408.5" x2="701.5" y1="396.2891" y2="396.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="420.5" y="391.2231">on_dsk_report()</text><polygon fill="#A80036" points="119,481.9531,109,485.9531,119,489.9531,115,485.9531" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="113" x2="402.5" y1="485.9531" y2="485.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="153" x="125" y="420.356">ucl/by-unid/&lt;gw-node&gt;/</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="118" x="125" y="435.4888">ProtocolController/</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="137" x="125" y="450.6216">NetworkManagement</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="125" y="465.7544">{"State": "add node",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113" x="125" y="480.8872">&lt;Request DSK&gt;}</text><path d="M5,498.9531 L5,568.9531 L208,568.9531 L208,508.9531 L198,498.9531 L5,498.9531 " fill="#FBFB77" filter="url(#fbp3uo8ly1xe7)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M198,498.9531 L198,508.9531 L208,508.9531 L198,498.9531 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176" x="11" y="516.02">User decides to supply DSK</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="11" y="531.1528">or Reject the DSK, which</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="11" y="546.2856">will end up with a non secure</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="11" y="561.4185">node inclusion</text><polygon fill="#A80036" points="391.5,656.1484,401.5,660.1484,391.5,664.1484,395.5,660.1484" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="108" x2="397.5" y1="660.1484" y2="660.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="153" x="115" y="594.5513">ucl/by-unid/&lt;gw-node&gt;/</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="118" x="115" y="609.6841">ProtocolController/</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="173" x="115" y="624.8169">NetworkManagement/Write</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="115" y="639.9497">{"State":"add node"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="115" y="655.0825">DSK or "UserAccept"=false}</text><polygon fill="#A80036" points="690.5,685.2813,700.5,689.2813,690.5,693.2813,694.5,689.2813" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="403.5" x2="696.5" y1="689.2813" y2="689.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="256" x="410.5" y="684.2153">zwave_network_management_dsk_set()</text><polygon fill="#A80036" points="414.5,714.4141,404.5,718.4141,414.5,722.4141,410.5,718.4141" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="408.5" x2="701.5" y1="718.4141" y2="718.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="420.5" y="713.3481">on_node_added()</text><polygon fill="#A80036" points="119,773.8125,109,777.8125,119,781.8125,115,777.8125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="113" x2="402.5" y1="777.8125" y2="777.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="153" x="125" y="742.481">ucl/by-unid/&lt;gw-node&gt;/</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="255" x="125" y="757.6138">ProtocolController/NetworkManagement</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="242" x="125" y="772.7466">NetworkManagement {"State": "Idle"}</text><!--MD5=[0b2c82d360588fb8cf92c3eee96d4648]
@startuml inline_umlgraph_3.svg
  box "MQTT Broker" #LightYellow
  participant MQTT
  end box

  box "ZPC" #LightBlue

  participant UclNetworkManagement
  participant NetworkManagement
  end box
  '<i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/NetworkManagement</i>\n{"State": "Idle"}
  note over MQTT: User trigger Add Node
  MQTT                  -> UclNetworkManagement : <i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/</i>\n<i>NetworkManagement/Write</i>\n{"State": "add node", ...}
  UclNetworkManagement  -> NetworkManagement    : zwave_network_management_add_node()
  NetworkManagement     -> UclNetworkManagement : on_state_updated(NM_WAITING_FOR_ADD)
  UclNetworkManagement  -> MQTT                 : <i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/</i>\n<i>NetworkManagement</i>\n{"State": "add node", ...}
  NetworkManagement     -> UclNetworkManagement : on_keys_reported()
  UclNetworkManagement  -> NetworkManagement    : zwave_network_management_keys_set()
  NetworkManagement     -> UclNetworkManagement : on_dsk_report()
  UclNetworkManagement  -> MQTT                 : <i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/</i>\n<i>NetworkManagement</i>\n{"State": "add node",\n<Request DSK>}
  note over MQTT
  User decides to supply DSK
  or Reject the DSK, which
  will end up with a non secure
  node inclusion
  end note
  MQTT                  -> UclNetworkManagement : <i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/</i>\n<i>NetworkManagement/Write</i>\n{"State":"add node"\nDSK or "UserAccept"=false}
  UclNetworkManagement  -> NetworkManagement    : zwave_network_management_dsk_set()
  NetworkManagement     -> UclNetworkManagement : on_node_added()
  UclNetworkManagement  -> MQTT                 : <i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/NetworkManagement</i>\nNetworkManagement {"State": "Idle"}
@enduml

@startuml inline_umlgraph_3.svg
  box "MQTT Broker" #LightYellow
  participant MQTT
  end box

  box "ZPC" #LightBlue

  participant UclNetworkManagement
  participant NetworkManagement
  end box
  note over MQTT: User trigger Add Node
  MQTT                  -> UclNetworkManagement : <i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/</i>\n<i>NetworkManagement/Write</i>\n{"State": "add node", ...}
  UclNetworkManagement  -> NetworkManagement    : zwave_network_management_add_node()
  NetworkManagement     -> UclNetworkManagement : on_state_updated(NM_WAITING_FOR_ADD)
  UclNetworkManagement  -> MQTT                 : <i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/</i>\n<i>NetworkManagement</i>\n{"State": "add node", ...}
  NetworkManagement     -> UclNetworkManagement : on_keys_reported()
  UclNetworkManagement  -> NetworkManagement    : zwave_network_management_keys_set()
  NetworkManagement     -> UclNetworkManagement : on_dsk_report()
  UclNetworkManagement  -> MQTT                 : <i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/</i>\n<i>NetworkManagement</i>\n{"State": "add node",\n<Request DSK>}
  note over MQTT
  User decides to supply DSK
  or Reject the DSK, which
  will end up with a non secure
  node inclusion
  end note
  MQTT                  -> UclNetworkManagement : <i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/</i>\n<i>NetworkManagement/Write</i>\n{"State":"add node"\nDSK or "UserAccept"=false}
  UclNetworkManagement  -> NetworkManagement    : zwave_network_management_dsk_set()
  NetworkManagement     -> UclNetworkManagement : on_node_added()
  UclNetworkManagement  -> MQTT                 : <i>ucl/by-unid/<gw-node>/</i>\n<i>ProtocolController/NetworkManagement</i>\nNetworkManagement {"State": "Idle"}
@enduml

PlantUML version 1.2021.00(Sun Jan 10 10:25:05 UTC 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: ANSI_X3.4-1968
Language: en
Country: US
--></g></svg>
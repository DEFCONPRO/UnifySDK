<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1833px" preserveAspectRatio="none" style="width:1810px;height:1833px;background:#FFFFFF;" version="1.1" viewBox="0 0 1810 1833" width="1810px" zoomAndPan="magnify"><defs><filter height="300%" id="f9e25pv8x7bul" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[700dd1742b27c4d099ea98d6504a656e]
cluster Failing_Node_Monitor--><rect fill="#FEFECE" filter="url(#f9e25pv8x7bul)" height="1814" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="954" x="301" y="7"/><rect fill="#FFFFFF" height="1781.7031" rx="12.5" ry="12.5" style="stroke:#FFFFFF;stroke-width:1.0;" width="948" x="304" y="36.2969"/><line style="stroke:#A80036;stroke-width:1.5;" x1="301" x2="1255" y1="33.2969" y2="33.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="146" x="705" y="23.9951">Failing_Node_Monitor</text><!--MD5=[bcb18e1f3e8dbccd7ecbe53b354325f8]
cluster Send_NOP--><rect fill="#FEFECE" filter="url(#f9e25pv8x7bul)" height="1011" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="271" x="309" y="802"/><rect fill="#FFFFFF" height="978.7031" rx="12.5" ry="12.5" style="stroke:#FFFFFF;stroke-width:1.0;" width="265" x="312" y="831.2969"/><line style="stroke:#A80036;stroke-width:1.5;" x1="309" x2="580" y1="828.2969" y2="828.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="408" y="818.9951">Send_NOP</text><!--MD5=[df4748eb1e1e7e2796c43ee38a79f57e]
cluster Remove--><rect fill="#FEFECE" filter="url(#f9e25pv8x7bul)" height="937" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="284" x="927" y="386"/><rect fill="#FFFFFF" height="904.7031" rx="12.5" ry="12.5" style="stroke:#FFFFFF;stroke-width:1.0;" width="278" x="930" y="415.2969"/><line style="stroke:#A80036;stroke-width:1.5;" x1="927" x2="1211" y1="412.2969" y2="412.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="1040.5" y="402.9951">Remove</text><g id="Failing_Node_Monitor.Wait"><rect fill="#FF00FF" filter="url(#f9e25pv8x7bul)" height="50.2656" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="139" x="1107.5" y="1553.5"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1107.5" x2="1246.5" y1="1579.7969" y2="1579.7969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="1162.5" y="1571.4951">Wait</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="119" x="1112.5" y="1595.9355">wait for timer value</text></g><g id="Failing_Node_Monitor.Insert"><rect fill="#FEFECE" filter="url(#f9e25pv8x7bul)" height="78.2031" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="251" x="309.5" y="34"/><line style="stroke:#A80036;stroke-width:1.5;" x1="309.5" x2="560.5" y1="60.2969" y2="60.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="415.5" y="51.9951">Insert</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="218" x="314.5" y="76.4355">Insert node id into failing node list.</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="231" x="314.5" y="90.4043">Adjust all timer for all existing nodes.</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="150" x="314.5" y="104.373">Sort the failing node list</text></g><g id="Failing_Node_Monitor.Init"><rect fill="#FEFECE" filter="url(#f9e25pv8x7bul)" height="50" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="50" x="707" y="1265"/><line style="stroke:#A80036;stroke-width:1.5;" x1="707" x2="757" y1="1291.2969" y2="1291.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="20" x="722" y="1282.9951">Init</text></g><g id="Failing_Node_Monitor.Check_FailingList"><rect fill="#FEFECE" filter="url(#f9e25pv8x7bul)" height="64.2344" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="201" x="595.5" y="41"/><line style="stroke:#A80036;stroke-width:1.5;" x1="595.5" x2="796.5" y1="67.2969" y2="67.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="637.5" y="58.9951">Check_FailingList</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="181" x="600.5" y="83.4355">Check if node is in failing list.</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="125" x="600.5" y="97.4043">If it exists, remove it</text></g><g id="Failing_Node_Monitor.Adjust"><rect fill="#FEFECE" filter="url(#f9e25pv8x7bul)" height="50.2656" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="521" x="346.5" y="235"/><line style="stroke:#A80036;stroke-width:1.5;" x1="346.5" x2="867.5" y1="261.2969" y2="261.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="585.5" y="252.9951">Adjust</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="501" x="351.5" y="277.4355">Adjust next ping timer of all nodes in failing node list according to current timer.</text></g><g id="Failing_Node_Monitor.Check_Node_Type"><rect fill="#FEFECE" filter="url(#f9e25pv8x7bul)" height="50" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="149" x="394.5" y="413"/><line style="stroke:#A80036;stroke-width:1.5;" x1="394.5" x2="543.5" y1="439.2969" y2="439.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="129" x="404.5" y="430.9951">Check_Node_Type</text></g><g id="Failing_Node_Monitor.AL"><rect fill="#FEFECE" filter="url(#f9e25pv8x7bul)" height="50.2656" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="236" x="626" y="651"/><line style="stroke:#A80036;stroke-width:1.5;" x1="626" x2="862" y1="677.2969" y2="677.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="16" x="736" y="668.9951">AL</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="216" x="631" y="693.4355">set initial timer value to 4 seconds</text></g><g id="Failing_Node_Monitor.FL"><rect fill="#FEFECE" filter="url(#f9e25pv8x7bul)" height="50.2656" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="244" x="347" y="651"/><line style="stroke:#A80036;stroke-width:1.5;" x1="347" x2="591" y1="677.2969" y2="677.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="15" x="461.5" y="668.9951">FL</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="224" x="352" y="693.4355">set initial timer value to 40 seconds</text></g><rect fill="#ADD8E6" filter="url(#f9e25pv8x7bul)" height="106.5625" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="484" x="588" y="1525"/><rect fill="#FFFFFF" height="74.2656" rx="12.5" ry="12.5" style="stroke:#FFFFFF;stroke-width:1.0;" width="478" x="591" y="1554.2969"/><line style="stroke:#A80036;stroke-width:1.5;" x1="588" x2="1072" y1="1551.2969" y2="1551.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="778.5" y="1542.9951">FailingNodeList</text><g id="Failing_Node_Monitor.FailingNodeList.Node1"><rect fill="#008000" filter="url(#f9e25pv8x7bul)" height="50.2656" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="140" x="600" y="1563.2969"/><line style="stroke:#A80036;stroke-width:1.5;" x1="600" x2="740" y1="1589.5938" y2="1589.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46" x="647" y="1581.292">Node1</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="120" x="605" y="1605.7324">next ping, last ping</text></g><g id="Failing_Node_Monitor.FailingNodeList.Node2"><rect fill="#008000" filter="url(#f9e25pv8x7bul)" height="50.2656" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="140" x="758" y="1563.2969"/><line style="stroke:#A80036;stroke-width:1.5;" x1="758" x2="898" y1="1589.5938" y2="1589.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46" x="805" y="1581.292">Node2</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="120" x="763" y="1605.7324">next ping, last ping</text></g><g id="Failing_Node_Monitor.FailingNodeList.Node3"><rect fill="#008000" filter="url(#f9e25pv8x7bul)" height="50.2656" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="140" x="916" y="1563.2969"/><line style="stroke:#A80036;stroke-width:1.5;" x1="916" x2="1056" y1="1589.5938" y2="1589.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46" x="963" y="1581.292">Node3</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="120" x="921" y="1605.7324">next ping, last ping</text></g><g id="Failing_Node_Monitor.Send_NOP.Send_NOP_First"><rect fill="#FEFECE" filter="url(#f9e25pv8x7bul)" height="50.2656" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="219" x="317.5" y="845"/><line style="stroke:#A80036;stroke-width:1.5;" x1="317.5" x2="536.5" y1="871.2969" y2="871.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="372.5" y="862.9951">Send_NOP_First</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="199" x="322.5" y="887.4355">send NOP to first item in the list</text></g><g id="Failing_Node_Monitor.Send_NOP.Change_Intervals"><rect fill="#FEFECE" filter="url(#f9e25pv8x7bul)" height="64.2344" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="227" x="344.5" y="1258"/><line style="stroke:#A80036;stroke-width:1.5;" x1="344.5" x2="571.5" y1="1284.2969" y2="1284.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="118" x="399" y="1275.9951">Change_Intervals</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="187" x="349.5" y="1300.4355">For AL: double the timer value</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="207" x="349.5" y="1314.4043">For FL: quadraple the timer value</text></g><g id="Failing_Node_Monitor.Send_NOP.And_wait"><rect fill="#FEFECE" filter="url(#f9e25pv8x7bul)" height="50" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="81" x="454.5" y="1755"/><line style="stroke:#A80036;stroke-width:1.5;" x1="454.5" x2="535.5" y1="1781.2969" y2="1781.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="464.5" y="1772.9951">And_wait</text></g><g id="Failing_Node_Monitor.Remove.Remove_Failing_List"><rect fill="#FEFECE" filter="url(#f9e25pv8x7bul)" height="50.2656" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="233" x="934.5" y="413"/><line style="stroke:#A80036;stroke-width:1.5;" x1="934.5" x2="1167.5" y1="439.2969" y2="439.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="137" x="982.5" y="430.9951">Remove_Failing_List</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="213" x="939.5" y="455.4355">remove node from failing node list</text></g><g id="Failing_Node_Monitor.Remove.Remvoe_Attribute_Store"><rect fill="#FEFECE" filter="url(#f9e25pv8x7bul)" height="50.2656" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="197" x="964.5" y="845"/><line style="stroke:#A80036;stroke-width:1.5;" x1="964.5" x2="1161.5" y1="871.2969" y2="871.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="167" x="979.5" y="862.9951">Remvoe_Attribute_Store</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="177" x="969.5" y="887.4355">Remove from Attribute store</text></g><g id="Failing_Node_Monitor.Remove.Stop_Timer"><rect fill="#FEFECE" filter="url(#f9e25pv8x7bul)" height="50.2656" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="255" x="935.5" y="1265"/><line style="stroke:#A80036;stroke-width:1.5;" x1="935.5" x2="1190.5" y1="1291.2969" y2="1291.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="1024" y="1282.9951">Stop_Timer</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="235" x="940.5" y="1307.4355">Stop timer if Failing Node list is empty</text></g><ellipse cx="16" cy="73" fill="#000000" filter="url(#f9e25pv8x7bul)" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><g id="Network_Monitor"><rect fill="#FEFECE" filter="url(#f9e25pv8x7bul)" height="50" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="136" x="61" y="48"/><line style="stroke:#A80036;stroke-width:1.5;" x1="61" x2="197" y1="74.2969" y2="74.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="71" y="65.9951">Network_Monitor</text></g><g id="Attribute_Store"><rect fill="#FEFECE" filter="url(#f9e25pv8x7bul)" height="50" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="123" x="1494.5" y="1414"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1494.5" x2="1617.5" y1="1440.2969" y2="1440.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="1504.5" y="1431.9951">Attribute_Store</text></g><g id="ZWave_utils"><rect fill="#FEFECE" filter="url(#f9e25pv8x7bul)" height="50" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="102" x="120" y="540"/><line style="stroke:#A80036;stroke-width:1.5;" x1="120" x2="222" y1="566.2969" y2="566.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="130" y="557.9951">ZWave_utils</text></g><g id="Zwave_Controller"><rect fill="#FEFECE" filter="url(#f9e25pv8x7bul)" height="50.2656" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="181" x="1263.5" y="956"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1263.5" x2="1444.5" y1="982.2969" y2="982.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119" x="1294.5" y="973.9951">Zwave_Controller</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="161" x="1268.5" y="998.4355">Call zwave_tx to send NOP</text></g><ellipse cx="1354" cy="1093" filter="url(#f9e25pv8x7bul)" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;fill:none;"/><ellipse cx="1354.5" cy="1093.5" fill="#000000" rx="6" ry="6" style="stroke:none;stroke-width:1.0;"/><!--MD5=[ce45e93afe357b622f3bd093b8561d2e]
link *start to Network_Monitor--><path d="M26.1523,73 C35.9596,73 45.7669,73 55.5742,73 " fill="none" id="*start-to-Network_Monitor" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="60.7027,73,51.7027,69,55.7027,73,51.7027,77,60.7027,73" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[a154c5bc8e3c7f51a9c39e5e8db3edb1]
link Network_Monitor to Insert--><path d="M197.2915,73 C228.7702,73 267.2345,73 303.9727,73 " fill="none" id="Network_Monitor-to-Insert" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="309.3795,73,300.3795,69,304.3795,73,300.3795,77,309.3795,73" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="215.25" y="66.0669">Node offline</text><!--MD5=[318d2a0793326c1e131c99bfba6177bd]
link Network_Monitor to Init--><path d="M71.666,98.1168 C43.2778,114.7993 15,139.8598 15,173.5 C15,173.5 15,173.5 15,1188.5 C15,1252.6333 524.7878,1247.1697 588,1258 C627.7296,1264.807 673.0388,1275.34 702.0487,1282.4443 " fill="none" id="Network_Monitor-to-Init" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="706.9156,1283.6414,699.1317,1277.6073,702.0604,1282.447,697.2206,1285.3756,706.9156,1283.6414" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="16" y="680.5669">Initialization</text><!--MD5=[e128e177f111bf928f55045163d01dc2]
link Init to FailingNodeList--><path d="M738.6973,1315.0098 C747.9802,1349.0182 765.6933,1411.6166 784,1464 C790.3956,1482.3005 798.0174,1501.9701 805.1995,1519.7541 " fill="none" id="Init-to-FailingNodeList" style="stroke:#0000FF;stroke-width:2.0;"/><polygon fill="#0000FF" points="807.2122,1524.7174,807.5369,1514.8739,805.3332,1520.0839,800.1232,1517.8803,807.2122,1524.7174" style="stroke:#0000FF;stroke-width:2.0;"/><!--MD5=[0942b41d479407611d028c22562381d8]
link Insert to FailingNodeList--><path d="M402.679,112.0051 C378.4973,143.3041 346.672,189.4011 329,235 C310.8606,281.8051 311,296.3029 311,346.5 C311,346.5 311,346.5 311,620.5 C311,657.2608 305.9067,673.2355 330,701 C410.7069,794.0046 491.522,725.4791 588,802 C758.4524,937.1932 830,1009.9426 830,1227.5 C830,1227.5 830,1227.5 830,1439 C830,1465.4543 830,1494.7304 830,1519.6041 " fill="none" id="Insert-to-FailingNodeList" style="stroke:#0000FF;stroke-width:2.0;"/><polygon fill="#0000FF" points="830,1524.8425,834,1515.8425,830,1519.8425,826,1515.8425,830,1524.8425" style="stroke:#0000FF;stroke-width:2.0;"/><!--MD5=[5b953e69ea7d4fb97404a81d33d38958]
link Network_Monitor to Remove--><path d="M142.2322,98.2794 C151.4131,118.1661 162,146.8715 162,173.5 C162,173.5 162,173.5 162,346.5 C162,374.9379 406.3287,376.3434 656.3681,374.8742 C781.3878,374.1396 907.8351,372.6863 1005.8828,373.534 C1054.9067,373.9579 1096.8307,374.957 1127.9263,376.9089 C1143.4742,377.8848 1156.3149,379.0989 1165.9826,380.5983 C1170.8164,381.3481 1174.8569,382.1691 1178.0459,383.0675 C1179.6404,383.5166 1181.022,383.9851 1182.1834,384.4736 C1182.7642,384.7178 1183.2899,384.9671 1183.7596,385.2215 C1183.9944,385.3487 1184.2153,385.4771 1184.4221,385.6069 " fill="none" id="Network_Monitor-to-Remove" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1184.4221,385.6069,1178.9247,377.435,1180.1868,382.9493,1174.6726,384.2114,1184.4221,385.6069" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="163" y="264.5669">Node online</text><!--MD5=[f045891a60b1d081b3671451eea09034]
link Insert to Check_FailingList--><path d="M560.6572,73 C570.4867,73 580.3162,73 590.1457,73 " fill="none" id="Insert-to-Check_FailingList" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="595.2859,73,586.2859,69,590.2859,73,586.2859,77,595.2859,73" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[85ce11c2464d3fd2c80e2699b259850b]
link Check_FailingList to FailingNodeList--><path d="M756.0943,105.2754 C800.869,133.0459 858.6348,177.6762 885,235 C894.2857,255.1892 885.1335,262.7782 885,285 C881.766,823.1565 881.7288,958.5327 839,1495 C838.3673,1502.944 837.5945,1511.302 836.7703,1519.5352 " fill="none" id="Check_FailingList-to-FailingNodeList" style="stroke:#0000FF;stroke-width:2.0;"/><polygon fill="#0000FF" points="836.2512,1524.6406,841.1412,1516.0915,836.757,1519.6663,833.1823,1515.2821,836.2512,1524.6406" style="stroke:#0000FF;stroke-width:2.0;"/><!--MD5=[b5a8b5be29911367c583c4544d01181d]
link Check_FailingList to Adjust--><path d="M680.7004,105.1464 C664.026,140.1813 637.5585,195.7929 621.2919,229.971 " fill="none" id="Check_FailingList-to-Adjust" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="618.9683,234.8532,626.448,228.4458,621.1171,230.3385,619.2245,225.0077,618.9683,234.8532" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[0fadd0a6c65e029e7889d54dee732b14]
link Adjust to Check_Node_Type--><path d="M587.5207,285.1255 C562.3185,317.6327 518.4875,374.1684 491.7737,408.6252 " fill="none" id="Adjust-to-Check_Node_Type" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="488.6032,412.7147,497.2788,408.0528,491.6667,408.7632,490.9564,403.1511,488.6032,412.7147" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[426d6cd582a55cba4bf20267ca53330e]
link Check_Node_Type to AL--><path d="M497.9101,463.0203 C549.4882,507.6589 657.0354,600.7361 711.2545,647.6603 " fill="none" id="Check_Node_Type-to-AL" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="715.0647,650.9578,710.8768,642.0437,711.2839,647.6859,705.6417,648.0929,715.0647,650.9578" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[47fd46a8ca2df68bda59820051d07a4a]
link Check_Node_Type to FL--><path d="M469,463.0203 C469,507.1232 469,598.5092 469,645.9512 " fill="none" id="Check_Node_Type-to-FL" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="469,650.9578,473,641.9578,469,645.9578,465,641.9578,469,650.9578" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[d37ef00bb934d5ad0f475083f6c8721c]
link AL to Send_NOP--><path d="M689.1212,701.1317 C669.6627,711.636 647.5512,725.3715 627.22,742.2217 C617.0543,750.6468 607.3338,759.8506 598.6124,769.8185 C594.2517,774.8024 590.1408,779.9774 586.349,785.3416 C584.4531,788.0237 582.6369,790.7531 580.9092,793.5296 C580.0454,794.9178 579.2036,796.3178 578.385,797.7296 C577.9758,798.4354 577.5723,799.1443 577.1747,799.856 C576.9759,800.2119 576.7787,800.5685 576.5829,800.9258 C576.485,801.1045 576.3874,801.2833 576.2903,801.4624 " fill="none" id="AL-to-Send_NOP" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="576.2903,801.4624,584.0984,795.4595,578.6749,797.0676,577.0668,791.6441,576.2903,801.4624" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[9c991c24ec1f51dd865fb289a636a391]
link FL to Send_NOP--><path d="M489.621,701.0315 C499.2035,713.2323 511.0173,729.0436 522.5759,746.5202 C528.3552,755.2584 534.0707,764.413 539.4117,773.7407 C542.0821,778.4045 544.659,783.1117 547.1033,787.8317 C548.3255,790.1917 549.5145,792.5549 550.6656,794.9176 C551.2411,796.0989 551.8072,797.2801 552.3631,798.4606 C552.6411,799.0509 552.9165,799.6411 553.1894,800.231 C553.3258,800.5259 553.4615,800.8208 553.5967,801.1157 C553.6642,801.2631 553.7316,801.4105 553.7988,801.5579 " fill="none" id="FL-to-Send_NOP" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="553.7988,801.5579,553.7034,791.7095,551.724,797.0087,546.4247,795.0293,553.7988,801.5579" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[674318fdb65b614d953ed67fab24186c]
link Send_NOP_First to Change_Intervals--><path d="M432.4153,895.4389 C436.7119,917.8524 442,951.4421 442,981 C442,981 442,981 442,1188.5 C442,1209.861 445.5005,1233.4456 449.2269,1252.5002 " fill="none" id="Send_NOP_First-to-Change_Intervals" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="450.2812,1257.7488,452.4304,1248.1373,449.2965,1252.8467,444.5871,1249.7128,450.2812,1257.7488" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[37c6af5afd8ad0acb8a52ea1794882b7]
link Change_Intervals to FailingNodeList--><path d="M499.5903,1322.2548 C561.8016,1370.502 679.9802,1462.154 756.8382,1521.7603 " fill="none" id="Change_Intervals-to-FailingNodeList" style="stroke:#0000FF;stroke-width:2.0;"/><polygon fill="#0000FF" points="760.9236,1524.9286,756.2631,1516.2522,756.9726,1521.8644,751.3604,1522.5739,760.9236,1524.9286" style="stroke:#0000FF;stroke-width:2.0;"/><!--MD5=[b6e64eefd28f2b23e28bfa83de8a62dc]
link Change_Intervals to And_wait--><path d="M461.0721,1322.2287 C463.6793,1352.3844 467,1398.7019 467,1439 C467,1439 467,1439 467,1693.5 C467,1712.9544 473.4901,1733.7262 480.2211,1750.0375 " fill="none" id="Change_Intervals-to-And_wait" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="482.3108,1754.95,482.4685,1745.1024,480.3535,1750.349,475.1069,1748.2341,482.3108,1754.95" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[1273a6ff5075540e53d55f232b265fbd]
link And_wait to Wait--><path d="M535.6932,1774.2995 C634.0034,1759.5953 891.0126,1715.5595 1090,1632 C1106.1493,1625.2185 1122.7893,1615.7048 1137.1368,1606.5771 " fill="none" id="And_wait-to-Wait" style="stroke:#FF00FF;stroke-width:2.0;"/><polygon fill="#FF00FF" points="1141.5128,1603.7602,1131.7801,1605.2681,1137.3085,1606.4665,1136.1101,1611.9949,1141.5128,1603.7602" style="stroke:#FF00FF;stroke-width:2.0;"/><!--MD5=[fd03114f9c709d080084e300c2986acc]
link Wait to Send_NOP--><path d="M1138.6329,1553.3259 C1058.0125,1500.053 874.0788,1376.4321 821,1323 C796.0577,1297.8917 797.7049,1285.1483 775,1258 C733.5423,1208.4288 688,1206.1224 688,1141.5 C688,981 688,981 688,981 C688,949.6202 668.0305,941.5992 644.0458,934.6837 C632.0534,931.2259 619.0572,928.0445 607.0515,922.3578 C601.0486,919.5144 595.2934,916.0447 590.035,911.601 C587.4059,909.3791 584.9009,906.9138 582.5514,904.1614 C581.964,903.4733 581.3863,902.7673 580.8188,902.0427 C580.6769,901.8615 580.5357,901.6792 580.3951,901.4957 " fill="none" id="Wait-to-Send_NOP" style="stroke:#FF00FF;stroke-width:2.0;"/><polygon fill="#FF00FF" points="580.3951,901.4957,582.6935,911.0726,583.436,905.4647,589.0439,906.2072,580.3951,901.4957" style="stroke:#FF00FF;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="708" y="1193.0669">Send NOP again</text><!--MD5=[f43ea2b5be356f25b39f36ce6b531d8f]
link Remove_Failing_List to FailingNodeList--><path d="M1133.8464,463.0744 C1179.4954,482.5643 1227,514.8856 1227,565 C1227,565 1227,565 1227,1368 C1227,1423.2504 1105.4629,1481.8031 996.8813,1523.0895 " fill="none" id="Remove_Failing_List-to-FailingNodeList" style="stroke:#0000FF;stroke-width:2.0;"/><polygon fill="#0000FF" points="992.0477,1524.9193,1001.8809,1525.474,996.7239,1523.1491,999.0487,1517.9921,992.0477,1524.9193" style="stroke:#0000FF;stroke-width:2.0;"/><!--MD5=[07a545411e82b9b04d01057e8498107a]
link Stop_Timer to FailingNodeList--><path d="M1042.7304,1315.0978 C1005.9493,1360.64 927.3402,1457.9736 876.6671,1520.7169 " fill="none" id="Stop_Timer-to-FailingNodeList" style="stroke:#0000FF;stroke-width:2.0;"/><polygon fill="#0000FF" points="873.3705,1524.7988,882.1371,1520.3104,876.512,1520.909,875.9134,1515.2839,873.3705,1524.7988" style="stroke:#0000FF;stroke-width:2.0;"/><!--MD5=[8a3be92d723474e5e2daa403fe5128b4]
link Stop_Timer to Wait--><path d="M1072.9173,1315.0978 C1093.8878,1368.1678 1142.6481,1491.5656 1165.1869,1548.6046 " fill="none" id="Stop_Timer-to-Wait" style="stroke:#FF00FF;stroke-width:2.0;"/><polygon fill="#FF00FF" points="1167.0244,1553.2548,1167.4369,1543.4146,1165.1868,1548.6047,1159.9967,1546.3547,1167.0244,1553.2548" style="stroke:#FF00FF;stroke-width:2.0;"/><!--MD5=[8d99c6b8b9699f17c0ef5c14481c298c]
link Remove_Failing_List to Remvoe_Attribute_Store--><path d="M1052.8984,463.2842 C1054.6563,488.9028 1057,529.6829 1057,565 C1057,565 1057,565 1057,762.5 C1057,788.6304 1058.7891,818.2782 1060.4134,839.8102 " fill="none" id="Remove_Failing_List-to-Remvoe_Attribute_Store" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1060.7999,844.8262,1064.0966,835.5455,1060.4158,839.841,1056.1203,836.1601,1060.7999,844.8262" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[070e583b50dec50f6738b2c52e92e636]
link Remvoe_Attribute_Store to Stop_Timer--><path d="M1063,895.1282 C1063,917.6259 1063,951.5156 1063,981 C1063,981 1063,981 1063,1188.5 C1063,1212.4405 1063,1239.5573 1063,1259.7364 " fill="none" id="Remvoe_Attribute_Store-to-Stop_Timer" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1063,1264.9727,1067,1255.9727,1063,1259.9727,1059,1255.9727,1063,1264.9727" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[a69eab0d42fbe0b806d7e2bf86b18fe1]
link Init to Attribute_Store--><path d="M757.1106,1294.5406 C868.2843,1314.6436 1318.2207,1396.0035 1489.4266,1426.9619 " fill="none" id="Init-to-Attribute_Store" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1494.41,1427.863,1486.2655,1422.3251,1489.4898,1426.9732,1484.8418,1430.1974,1494.41,1427.863" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="1243" y="1365.0669">Read failing nodes if any</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="1254.5" y="1380.1997">and their last interval</text><!--MD5=[437c7c9efdde7ab33d83f5e3f0d7db3d]
link Remvoe_Attribute_Store to Attribute_Store--><path d="M1161.7082,875.4814 C1290.0515,885.3652 1498,912.0224 1498,981 C1498,981 1498,981 1498,1290 C1498,1333.7396 1519.9734,1380.0838 1536.8705,1409.2555 " fill="none" id="Remvoe_Attribute_Store-to-Attribute_Store" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1539.5347,1413.7869,1538.4215,1404.0012,1537.0006,1409.4767,1531.5251,1408.0558,1539.5347,1413.7869" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="1499" y="1146.0669">Remove value</text><!--MD5=[e5aee94cdcea2a088836921112a081de]
link AL to Attribute_Store--><path d="M862.0722,679.1762 C1070.1584,685.4539 1493.8888,701.4675 1639,731 C1680.1171,739.368 1728,720.54 1728,762.5 C1728,762.5 1728,762.5 1728,1290 C1728,1348.3662 1670.7189,1388.989 1622.269,1412.9098 " fill="none" id="AL-to-Attribute_Store" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1617.6101,1415.1726,1627.4533,1414.8384,1622.1076,1412.9881,1623.958,1407.6424,1617.6101,1415.1726" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="1729" y="1049.0669">Store value</text><!--MD5=[9e58813651d470f42536285a9ab0005f]
link FL to Attribute_Store--><path d="M591.0425,698.6495 C597.1052,699.5058 603.1163,700.2968 609,701 C664.4875,707.6312 1613,706.6177 1613,762.5 C1613,762.5 1613,762.5 1613,1290 C1613,1333.6411 1591.4055,1380.0081 1574.7997,1409.2118 " fill="none" id="FL-to-Attribute_Store" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1572.1814,1413.7484,1580.1447,1407.953,1574.6808,1409.4179,1573.2159,1403.954,1572.1814,1413.7484" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="1614" y="1049.0669">Store value</text><!--MD5=[04aad3252ad8980f7a4b945f2c374d75]
link Check_Node_Type to ZWave_utils--><path d="M394.3993,443.0504 C284.8141,451.2381 90.9625,468.9497 70,493 C50.2432,515.667 82.0868,535.0274 115.1186,547.9447 " fill="none" id="Check_Node_Type-to-ZWave_utils" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="119.9948,549.8034,113.0097,542.8602,115.3227,548.0226,110.1603,550.3356,119.9948,549.8034" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189" x="71" y="506.0669">zwave_get_operating_mode()</text><!--MD5=[5bbec32b7c6d78296ab24db0a300ae07]
link ZWave_utils to Check_Node_Type--><path d="M222.2996,543.1374 C272.9787,521.5393 350.6255,488.4482 405.2438,465.1713 " fill="none" id="ZWave_utils-to-Check_Node_Type" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="410.1248,463.0911,400.2771,462.9398,405.5251,465.0514,403.4136,470.2994,410.1248,463.0911" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[fd1cbd99149d127be0b9c0cc1197d689]
link Send_NOP_First to Zwave_Controller--><path d="M536.692,892.2126 C542.5379,893.2025 548.3347,894.1396 554,895 C807.0126,933.4273 1107.6028,960.8982 1258.0979,973.4144 " fill="none" id="Send_NOP_First-to-Zwave_Controller" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1263.3878,973.8533,1254.7495,969.1226,1258.4049,973.4397,1254.0878,977.0952,1263.3878,973.8533" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[161e607eca95ce6dde4b807955146f56]
link Zwave_Controller to *end--><path d="M1354,1006.135 C1354,1027.9947 1354,1058.9793 1354,1077.4282 " fill="none" id="Zwave_Controller-to-*end" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1354,1082.7272,1358,1073.7272,1354,1077.7272,1350,1073.7272,1354,1082.7272" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[342f87011f075f4707a48bf9d6af7d4b]
@startuml inline_umlgraph_1.svg
[*] -> Network_Monitor
state Failing_Node_Monitor {
  State Wait#magenta
      state FailingNodeList #lightblue {
          state Node1 #Green
  Node1: next ping, last ping
          state Node2 #Green
  Node2: next ping, last ping
          state Node3 #Green
  Node3: next ping, last ping
  
      }
  Network_Monitor -> Insert: Node offline
  Network_Monitor -> Init: Initialization
  Init-[#blue,bold]->FailingNodeList
  Insert-[#blue,bold]->FailingNodeList
  Network_Monitor -> Remove : Node online
  Insert: Insert node id into failing node list.
  Insert->Check_FailingList
  Check_FailingList-[#blue,bold]->FailingNodeList
  
  Check_FailingList: Check if node is in failing list.
  Check_FailingList: If it exists, remove it
  Check_FailingList- ->Adjust
  Adjust:Adjust next ping timer of all nodes in failing node list according to current timer.
  Adjust- ->Check_Node_Type
  state Check_Node_Type << fork >>
  Check_Node_Type - -> AL
  Check_Node_Type - -> FL
  AL:set initial timer value to 4 seconds
  FL: set initial timer value to 40 seconds
  
  state Send_NOP << join >>
  AL- -> Send_NOP
  FL- -> Send_NOP
  Insert: Adjust all timer for all existing nodes.
  Insert: Sort the failing node list
  
  state Send_NOP {
    Send_NOP_First- ->Change_Intervals
    Change_Intervals-[#blue,bold]->FailingNodeList
    Change_Intervals: For AL: double the timer value
    Change_Intervals: For FL: quadraple the timer value
    Send_NOP_First: send NOP to first item in the list
    Change_Intervals- ->And_wait
    And_wait-[#magenta,bold]->Wait
  }
  
  
  Wait -[#magenta,bold]-> Send_NOP: Send NOP again
  Wait: wait for timer value
  state Remove {
    Remove_Failing_List-[#blue,bold]->FailingNodeList
    Remove_Failing_List: remove node from failing node list
    Remvoe_Attribute_Store: Remove from Attribute store
    Stop_Timer: Stop timer if Failing Node list is empty
    Stop_Timer-[#blue,bold]->FailingNodeList
    Stop_Timer-[#magenta,bold]->Wait
    Remove_Failing_List- ->Remvoe_Attribute_Store
    Remvoe_Attribute_Store- ->Stop_Timer
  }
}
Init- ->Attribute_Store: Read failing nodes if any \nand their last interval
Remvoe_Attribute_Store->Attribute_Store: Remove value
AL- ->Attribute_Store: Store value
FL- ->Attribute_Store: Store value
Check_Node_Type- ->ZWave_utils: zwave_get_operating_mode()
ZWave_utils- ->Check_Node_Type
Send_NOP_First - -> Zwave_Controller
Zwave_Controller: Call zwave_tx to send NOP
Zwave_Controller- ->[*]
@enduml

PlantUML version 1.2022.0(Tue Jan 11 16:16:42 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: ANSI_X3.4-1968
Language: en
Country: US
--></g></svg>
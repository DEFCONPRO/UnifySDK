<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="513px" preserveAspectRatio="none" style="width:1270px;height:513px;background:#FFFFFF;" version="1.1" viewBox="0 0 1270 513" width="1270px" zoomAndPan="magnify"><defs><filter height="300%" id="f13zo09emmq6hq" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFE0" height="501.6641" style="stroke:#A80036;stroke-width:1.0;" width="100" x="1" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94" x="4" y="18.0669">MQTT Broker</text><rect fill="#ADD8E6" height="501.6641" style="stroke:#A80036;stroke-width:1.0;" width="1019" x="245.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="740" y="18.0669">ZPC</text><line style="stroke:#A80036;stroke-width:1.0;" x1="50.5" x2="50.5" y1="60.4297" y2="167.8281"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="50.5" x2="50.5" y1="167.8281" y2="208.6328"/><line style="stroke:#A80036;stroke-width:1.0;" x1="50.5" x2="50.5" y1="208.6328" y2="321.1641"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="50.5" x2="50.5" y1="321.1641" y2="361.9688"/><line style="stroke:#A80036;stroke-width:1.0;" x1="50.5" x2="50.5" y1="361.9688" y2="469.3672"/><line style="stroke:#A80036;stroke-width:1.0;" x1="295.5" x2="295.5" y1="60.4297" y2="167.8281"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="295.5" x2="295.5" y1="167.8281" y2="208.6328"/><line style="stroke:#A80036;stroke-width:1.0;" x1="295.5" x2="295.5" y1="208.6328" y2="321.1641"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="295.5" x2="295.5" y1="321.1641" y2="361.9688"/><line style="stroke:#A80036;stroke-width:1.0;" x1="295.5" x2="295.5" y1="361.9688" y2="469.3672"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1203.5" x2="1203.5" y1="60.4297" y2="167.8281"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1203.5" x2="1203.5" y1="167.8281" y2="208.6328"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1203.5" x2="1203.5" y1="208.6328" y2="321.1641"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1203.5" x2="1203.5" y1="321.1641" y2="361.9688"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1203.5" x2="1203.5" y1="361.9688" y2="469.3672"/><rect fill="#FEFECE" filter="url(#f13zo09emmq6hq)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="55" x="21.5" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="28.5" y="45.1279">MQTT</text><rect fill="#FEFECE" filter="url(#f13zo09emmq6hq)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="55" x="21.5" y="468.3672"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="28.5" y="488.3623">MQTT</text><rect fill="#FEFECE" filter="url(#f13zo09emmq6hq)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="88" x="249.5" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="256.5" y="45.1279">StateTopic</text><rect fill="#FEFECE" filter="url(#f13zo09emmq6hq)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="88" x="249.5" y="468.3672"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="256.5" y="488.3623">StateTopic</text><rect fill="#FEFECE" filter="url(#f13zo09emmq6hq)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="110" x="1146.5" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="1153.5" y="45.1279">AttributeStore</text><rect fill="#FEFECE" filter="url(#f13zo09emmq6hq)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="110" x="1146.5" y="468.3672"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="1153.5" y="488.3623">AttributeStore</text><path d="M246,75.4297 L246,100.4297 L1252,100.4297 L1252,85.4297 L1242,75.4297 L246,75.4297 " fill="#FBFB77" filter="url(#f13zo09emmq6hq)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1242,75.4297 L1242,85.4297 L1252,85.4297 L1242,75.4297 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19" x="733" y="92.4966">Init</text><polygon fill="#A80036" points="1191.5,126.6953,1201.5,130.6953,1191.5,134.6953,1195.5,130.6953" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="295.5" x2="1197.5" y1="130.6953" y2="130.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="536" x="302.5" y="125.6294">attribute_store_register_callback_by_type(att_store_node_cb, ATTRIBUTE_NODE_ID)</text><polygon fill="#A80036" points="1191.5,155.8281,1201.5,159.8281,1191.5,163.8281,1195.5,159.8281" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="295.5" x2="1197.5" y1="159.8281" y2="159.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="884" x="302.5" y="154.7622">attribute_store_register_callback_by_type_and_state(att_store_network_status_cb, ATTRIBUTE_NETWORK_STATUS, REPORTED_ATTRIBUTE)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="0" x="629.25" y="192.0386"/><path d="M246,213.6328 L246,238.6328 L1252,238.6328 L1252,223.6328 L1242,213.6328 L246,213.6328 " fill="#FBFB77" filter="url(#f13zo09emmq6hq)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1242,213.6328 L1242,223.6328 L1252,223.6328 L1242,213.6328 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="441" x="522" y="230.6997">NETWORK_STATUS updated (NODE_STATE_TOPIC_STATE_INCLUDED)</text><polygon fill="#A80036" points="306.5,264.8984,296.5,268.8984,306.5,272.8984,302.5,268.8984" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="300.5" x2="1202.5" y1="268.8984" y2="268.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="459" x="312.5" y="263.8325">att_store_network_status_cb(NETWORK_STATUS, ATTRIBUTE_UPDATED)</text><polygon fill="#A80036" points="62,309.1641,52,313.1641,62,317.1641,58,313.1641" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="56" x2="294.5" y1="313.1641" y2="313.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="196" x="68" y="292.9653">ucl/by-unid/&lt;new-node&gt;/State</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204" x="68" y="308.0981">{"NetworkState": "Included", ...}</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="0" x="629.25" y="345.3745"/><path d="M246,366.9688 L246,391.9688 L1252,391.9688 L1252,376.9688 L1242,366.9688 L246,366.9688 " fill="#FBFB77" filter="url(#f13zo09emmq6hq)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1242,366.9688 L1242,376.9688 L1252,376.9688 L1242,366.9688 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="697.5" y="384.0356">Remove Node</text><polygon fill="#A80036" points="306.5,418.2344,296.5,422.2344,306.5,426.2344,302.5,422.2344" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="300.5" x2="1202.5" y1="422.2344" y2="422.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="320" x="312.5" y="417.1685">att_store_node_cb(node_id, ATTRIBUTE_DELETED)</text><polygon fill="#A80036" points="62,447.3672,52,451.3672,62,455.3672,58,451.3672" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="56" x2="294.5" y1="451.3672" y2="451.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="68" y="446.3013">delete</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="157" x="112" y="446.3013">ucl/by-unid/&lt;new-node&gt;</text><!--MD5=[f9a5563058112ad79ec4ddd7d9a83f70]
@startuml inline_umlgraph_5.svg
  box "MQTT Broker" #LightYellow
  participant MQTT
  end box

  box "ZPC" #LightBlue
  participant StateTopic
  participant AttributeStore
  end box
  note over StateTopic,AttributeStore: Init
  StateTopic          -> AttributeStore       : attribute_store_register_callback_by_type(att_store_node_cb, ATTRIBUTE_NODE_ID)
  StateTopic          -> AttributeStore       : attribute_store_register_callback_by_type_and_state(att_store_network_status_cb, ATTRIBUTE_NETWORK_STATUS, REPORTED_ATTRIBUTE)
  ... ...
  note over StateTopic,AttributeStore: NETWORK_STATUS updated (NODE_STATE_TOPIC_STATE_INCLUDED)
  AttributeStore      -> StateTopic           : att_store_network_status_cb(NETWORK_STATUS, ATTRIBUTE_UPDATED)
  StateTopic          -> MQTT                 : <i>ucl/by-unid/<new-node>/State</i>\n{"NetworkState": "Included", ...}
  ... ...
  note over StateTopic,AttributeStore: Remove Node
  AttributeStore      -> StateTopic           : att_store_node_cb(node_id, ATTRIBUTE_DELETED)
  StateTopic          -> MQTT                 : delete <i>ucl/by-unid/<new-node></i>
@enduml

PlantUML version 1.2022.0(Tue Jan 11 16:16:42 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: ANSI_X3.4-1968
Language: en
Country: US
--></g></svg>
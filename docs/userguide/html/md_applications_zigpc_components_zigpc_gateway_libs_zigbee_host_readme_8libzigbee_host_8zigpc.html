<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Unify SDK User Guide: Zigbee Host SLC Project Wrapper Library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Unify SDK User Guide
   &#160;<span id="projectnumber">1.1.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_applications_zigpc_components_zigpc_gateway_libs_zigbee_host_readme_8libzigbee_host_8zigpc.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Zigbee Host SLC Project Wrapper Library </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This directory creates a CMake target that abstracts functionality offered by a Zigbee Host framework as a static library. This wrapper library is used by ZigPC to send/receive events from the Zigbee network. The current implementation uses the Silicon Labs EmberZNet host framework to provide this functionality.</p>
<h1><a class="anchor" id="autotoc_md653"></a>
File structure</h1>
<pre class="fragment">|- CMakeLists.txt       CMake Configuration file.
|- include/             Wrapper API for Zigbee Host framework
                        accessible to other CMake targets.
|- src/                 Source files used to satisfy the API requirements.
|- gen/                 [Implementation-specific] Autogenerated files
                        used in combination with source files to build
                        Zigbee Host library.
</pre><h1><a class="anchor" id="autotoc_md654"></a>
Implementation Details</h1>
<p>The current implementation of the Wrapper API uses a Silicon Labs Universal Configurator (UC) based project. This project is derived used the ZigbeeHost Host UC project accessible at: <code>protocol/zigbee/app/framework/scenarios/z3/ZigbeeHost/ZigbeeHost.slcp</code></p>
<h2><a class="anchor" id="autotoc_md655"></a>
Dependencies</h2>
<p>The CMake target has dependencies on two vendor tools:</p><ol type="1">
<li>Silicon Labs Configurator(<code>slc</code>): This tool is used to autogenerate all the source-code needed to compile a UC project. This tool uses the configuration specified in <code>./src/libzigbee_host.slcp</code>. See the following user guide for more details: <a href="https://www.silabs.com/documents/public/user-guides/ug520-software-project-generation-configuration-with-slc-cli.pdf">UG520</a></li>
<li>ZCL Configurator (<code>zap</code>): This tool is used to generate the ZCL-specific behavior needed in a UC project. This tool is used by <code>slc</code> to generated these files. See the following application note for more details: <a href="https://www.silabs.com/documents/public/application-notes/an1325-zigbee-cluster-configurator-users-guide.pdf">AN1325: Zigbee Cluster Configurator User's Guide</a>.</li>
</ol>
<h2><a class="anchor" id="autotoc_md656"></a>
Build Process</h2>
<p>The CMake target uses the <code>ExternalProject_Add</code> step to define 2 commands to be executed in-order:</p><ol type="1">
<li><b>CONFIGURE</b>: This step invokes <code>slc</code> to autogenerate the UC project based on any changes to <code>./src/libzigbee_host.slcp</code>; To force slc re-build, run the cmake clean target for this component (i.e. for Ninja build system, execute: <code>ninja -t clean zigbee_host</code>).</li>
<li><b>BUILD</b>: This step invokes the following Makefile: <code>./gen/Makefile</code> which calls the UC generated Makefile project to compile and create the Zigbee host framework as a static library.</li>
</ol>
<p>NOTE: The currently supported compiler is GCC.</p>
<h2><a class="anchor" id="autotoc_md657"></a>
Adding Functionality</h2>
<p>The two configuration files are used to modify UC project:</p><ul>
<li>src/libzigbee_host.slcp: Configures Zigbee host related functionality offered by EmberZNet.</li>
<li>src/confg/zcl/zcl_config.zap: Configures ZCL related functionality.</li>
</ul>
<h3><a class="anchor" id="autotoc_md658"></a>
Adding an EmberZNet Component(a.k.a Plugin)</h3>
<p>To add an additional component to the UC project, add the component's ID under the <code>component</code> list defined in <code>./src/libzigbee_host.slcp</code>:</p>
<div class="fragment"><div class="line">component:</div>
<div class="line">  ...</div>
<div class="line">  - id: &quot;my_extra_component&quot;</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md659"></a>
Supporting Additional ZCL Clusters</h3>
<p>To add additional ZCL clusters to the UC project:</p><ul>
<li>Modify the ZAP ZCL configuration file in <code>./src/config/zcl/zcl_config.zap</code> to modify the ZCL request/response behavior for messages received on the Zigbee network.</li>
</ul>
<p>TODO: Include steps on how to modify ZCL config using ZAP</p>
<h3><a class="anchor" id="autotoc_md660"></a>
Add ZCL Cluster Command Message to Generic CommandReceieved Handler</h3>
<p>The Wrapper API contains a callback that is invoked for commands sent to supported ZCL clusters. To add to this support set: To add additional ZCL clusters to the UC project, do the following steps:</p><ul>
<li>Add the following 2 lines to the <code>template_contribution</code> list: <code>./src/libzigbee_host.slcp</code> with <code>&lt;CLUSTER_ID_HEX4&gt;</code> replaced with the ClusterID of choice:</li>
</ul>
<div class="fragment"><div class="line"># Redirecting ZCL commands sent for &lt;CLUSTER_ID_HEX4&gt; server cluster to emberAfClusterServiceCallback()</div>
<div class="line"> - {name: cluster_service, value: {cluster_id: &quot;&lt;CLUSTER_ID_HEX4&gt;&quot;, mfg_id: &quot;NOT_MFG_SPECIFIC&quot;, side: &quot;SERVER&quot;, service_function: &quot;emberAfClusterServiceCallback&quot;}}</div>
<div class="line"> </div>
<div class="line"># Redirecting ZCL commands sent for &lt;CLUSTER_ID_HEX4&gt; client cluster to emberAfClusterServiceCallback()</div>
<div class="line"> - {name: cluster_service, value: {cluster_id: &quot;CLUSTER_ID_HEX4&quot;, mfg_id: &quot;NOT_MFG_SPECIFIC&quot;, side: &quot;CLIENT&quot;, service_function: &quot;emberAfClusterServiceCallback&quot;}}</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Mar 23 2022 08:49:24 for Unify SDK User Guide by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>

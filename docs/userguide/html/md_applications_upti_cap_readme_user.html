<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Unify SDK User Guide: UPTI CAP User&#39;s Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Unify SDK User Guide
   &#160;<span id="projectnumber">1.1.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_applications_upti_cap_readme_user.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">UPTI CAP User's Guide </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>UPTI CAP is acronym for Unify Packet Trace Interface Capture</p>
<p><em><b>NOTE</b></em> To make UPTI CAP work, Silicon Labs WSTK adapters needs a special PTI enabled firmware</p>
<h1><a class="anchor" id="autotoc_md213"></a>
Description</h1>
<p>The <em>UPTI_CAP</em> is an application to communicate with Silicon Labs WSTK adapters, to capture data from adapters debug channel and to publish captured data as MQTT messages.</p>
<p>The types of data depend from application loaded on wireless SoC and debug adapter (it can includes energy consumption data, network packet data or any other data available over the debug channel).</p>
<p>On startup, <em>UPTI_CAP</em> automatically discovers and publish lists of debug adapters that are connected to the local subnet. You can also configure <em>UPTI_CAP</em> to discover debug adapters on other subnets by providing the IP adressess list as the command line argument. Adapters discovery can be started by publishing empty JSON to <code>ucl/UPTIСap/Discover</code> topic.</p>
<p>At discovery phase, application sends UDP broadcast packets to port 19020 on all network interfaces (or/and to IP adressess list from command line arguments) and waits for answers.</p>
<p>Application decodes answers (if any), identifies serial numbers, IP adresses and publishes list of supported devices to <code>ucl/UPTIСap/List</code> topic.</p>
<p>At capturing phase, application establishes TCP connection to port 4095 of adapter (debug channel), identifies debug messages in TCP stream, tries to parse messages and publishes trace packages to <code>ucl/UPTIСap/&lt;SerialNumber&gt;/TracePackage</code> topic.</p>
<p>Application allows to capture data from several adapters simultaneously. Capture/parse/publish task for each adapter runs as thread.</p>
<p>Capturing and publishing data from debug channel is disabled by default.</p>
<p>To start/stop capturing data and publishing trace packages an IoT Service MUST publish control message to <code>ucl/UPTIСap/&lt;SerialNumber&gt;/Toggle</code> topic.</p>
<p>Dev GUI application allows user to initiate adapters discovery, to start/stop trace packages capturing and visualize trace packages.</p>
<h1><a class="anchor" id="autotoc_md214"></a>
MQTT Topics and messages format</h1>
<ul>
<li><code>ucl/UPTIСap/Discover</code> - topic to control PTI compatible devices discovery. Message payload - empty JSON. <div class="fragment"><div class="line">{</div>
<div class="line">}</div>
</div><!-- fragment --></li>
<li><code>ucl/UPTIСap/List</code> - topic with the list of PTI compatible devices found in the network. Application publish list as retained message. <div class="fragment"><div class="line">{</div>
<div class="line">    &quot;$schema&quot;: &quot;http://json-schema.org/draft-07/schema#&quot;,</div>
<div class="line">    &quot;title&quot;: &quot;PTI devices list&quot;,</div>
<div class="line">    &quot;description&quot;: &quot;PTI devices list&quot;,</div>
<div class="line">    &quot;definitions&quot;: {</div>
<div class="line">      &quot;ListEntry&quot;: {</div>
<div class="line">        &quot;type&quot;: &quot;object&quot;,</div>
<div class="line">        &quot;properties&quot;: {</div>
<div class="line">            &quot;PTIAddress&quot;: {</div>
<div class="line">            &quot;description&quot;: &quot;PTI device IP address&quot;,    </div>
<div class="line">            &quot;type&quot;: &quot;string&quot;</div>
<div class="line">            },</div>
<div class="line">            &quot;SerialNumber&quot;: {</div>
<div class="line">            &quot;description&quot;: &quot;PTI device serial number&quot;,</div>
<div class="line">            &quot;type&quot;: &quot;string&quot;</div>
<div class="line">            },</div>
<div class="line">            &quot;Enabled&quot;: {</div>
<div class="line">            &quot;description&quot;: &quot;PTI device status&quot;,</div>
<div class="line">            &quot;type&quot;: &quot;boolean&quot;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">  },</div>
<div class="line">    &quot;type&quot;: &quot;object&quot;,</div>
<div class="line">    &quot;properties&quot;: {</div>
<div class="line">    &quot;value&quot;: {</div>
<div class="line">      &quot;type&quot;: &quot;array&quot;,</div>
<div class="line">      &quot;items&quot;: {</div>
<div class="line">        &quot;$ref&quot;: &quot;#/definitions/ListEntry&quot;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}   </div>
</div><!-- fragment --></li>
</ul>
<p>Example:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;value&quot;: [</div>
<div class="line">    {</div>
<div class="line">      &quot;PTIAddress&quot;: &quot;192.168.0.112&quot;,</div>
<div class="line">      &quot;SerialNumber&quot;: &quot;1234567&quot;,</div>
<div class="line">      &quot;Enabled&quot;: false</div>
<div class="line">    },</div>
<div class="line">    {</div>
<div class="line">      &quot;PTIAddress&quot;: &quot;192.168.0.122&quot;,</div>
<div class="line">      &quot;SerialNumber&quot;: &quot;7654321&quot;,</div>
<div class="line">      &quot;Enabled&quot;: false</div>
<div class="line">    }</div>
<div class="line">  ]</div>
<div class="line">}</div>
</div><!-- fragment --><ul>
<li><code>ucl/UPTIСap/&lt;SerialNumber&gt;/Toggle</code> - topic to control PTI coompatible device, where <code>SerialNumber</code> is the serial number of the WSTK board.</li>
</ul>
<div class="fragment"><div class="line">{</div>
<div class="line">    &quot;$schema&quot;: &quot;http://json-schema.org/draft-07/schema#&quot;,</div>
<div class="line">    &quot;title&quot;: &quot;PTI Toggle&quot;,</div>
<div class="line">    &quot;description&quot;: &quot;PTI Toggle payload&quot;,</div>
<div class="line">    &quot;type&quot;: &quot;object&quot;,</div>
<div class="line">    &quot;properties&quot;: {</div>
<div class="line">        &quot;Enable&quot;: {</div>
<div class="line">            &quot;description&quot;: &quot;Enable/Disable PTI Tracing Service&quot;,</div>
<div class="line">            &quot;type&quot;: &quot;boolean&quot;</div>
<div class="line">        },</div>
<div class="line">        &quot;GetOTA&quot;: {</div>
<div class="line">            &quot;description&quot;: &quot;Enable/Disable parsing OTA&quot;,</div>
<div class="line">            &quot;type&quot;: &quot;boolean&quot;,</div>
<div class="line">            &quot;default&quot;: false</div>
<div class="line">        },</div>
<div class="line">        &quot;GetAdditionalData&quot;: {</div>
<div class="line">            &quot;description&quot;: &quot;Enable/Disable parsing AdditionalData&quot;,</div>
<div class="line">            &quot;type&quot;: &quot;boolean&quot;,</div>
<div class="line">            &quot;default&quot;: false</div>
<div class="line">        }</div>
<div class="line">    },</div>
<div class="line">    &quot;required&quot;: [</div>
<div class="line">        &quot;Enable&quot;</div>
<div class="line">    ]</div>
<div class="line">}   </div>
</div><!-- fragment --><p>Example:</p>
<ul>
<li><code>ucl/UPTIСap/1234567/Toggle</code></li>
</ul>
<div class="fragment"><div class="line">{</div>
<div class="line">    &quot;Enable&quot;: true,</div>
<div class="line">    &quot;GetOTA&quot;: false,</div>
<div class="line">    &quot;GetAdditionalData&quot;: true</div>
<div class="line">}</div>
</div><!-- fragment --><ul>
<li><code>ucl/UPTICap/&lt;SerialNumber&gt;/TracePackage</code> - topic to publish traces from PTI compatible device, where <code>SerialNumber</code> is the serial number of the WSTK board.</li>
</ul>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;$schema&quot;: &quot;http://json-schema.org/draft-07/schema#&quot;,</div>
<div class="line">  &quot;title&quot;: &quot;PTI TracePackage&quot;,</div>
<div class="line">  &quot;description&quot;: &quot;PTI TracePackage payload&quot;,</div>
<div class="line">  &quot;type&quot;: &quot;object&quot;,</div>
<div class="line">  &quot;properties&quot;: {</div>
<div class="line">      &quot;TimeStamp&quot;: {</div>
<div class="line">          &quot;description&quot;: &quot;A timestamp encoded using RFC 3339&quot;,</div>
<div class="line">          &quot;type&quot;: &quot;string&quot;</div>
<div class="line">      },</div>
<div class="line">      &quot;RawFrame&quot;: {</div>
<div class="line">          &quot;description&quot;: &quot;Raw frame data&quot;,</div>
<div class="line">          &quot;type&quot;: &quot;array&quot;,</div>
<div class="line">          &quot;items&quot;: {</div>
<div class="line">              &quot;type&quot;: &quot;number&quot;</div>
<div class="line">          },</div>
<div class="line">      },</div>
<div class="line">      &quot;OTA&quot;: {</div>
<div class="line">          &quot;description&quot;: &quot;Parsed OTA data &quot;,</div>
<div class="line">          &quot;type&quot;: &quot;object&quot;,</div>
<div class="line">          &quot;default&quot;: null</div>
<div class="line">      },</div>
<div class="line">      &quot;AdditionalData&quot;: {</div>
<div class="line">          &quot;description&quot;: &quot;Parsed Additional Data&quot;,</div>
<div class="line">          &quot;type&quot;: &quot;object&quot;,</div>
<div class="line">          &quot;default&quot;: null,</div>
<div class="line">          &quot;properties&quot;: {</div>
<div class="line">              &quot;Rssi&quot;: {</div>
<div class="line">                  &quot;description&quot;: &quot;RSSI (Rx only)&quot;,</div>
<div class="line">                  &quot;type&quot;: &quot;number&quot;,</div>
<div class="line">                  &quot;default&quot;: null</div>
<div class="line">              },</div>
<div class="line">              &quot;Syncword&quot;: {</div>
<div class="line">                  &quot;description&quot;: &quot;SYNCWORD (optionally included, currently only for BLE protocol (Least significant byte first)&quot;,</div>
<div class="line">                  &quot;type&quot;: &quot;array&quot;,</div>
<div class="line">                  &quot;items&quot;: {</div>
<div class="line">                      &quot;type&quot;: &quot;number&quot;</div>
<div class="line">                  },</div>
<div class="line">                  &quot;default&quot;: null</div>
<div class="line">              },</div>
<div class="line">              &quot;RadioConfig&quot;: {</div>
<div class="line">                  &quot;description&quot;: &quot;Depending on the protocol contains: Zigbee Modem Config Id, Z-Wave Region Id, BLE PHY Id (included only if non-zero)&quot;,</div>
<div class="line">                  &quot;type&quot;: &quot;number&quot;,</div>
<div class="line">                  &quot;default&quot;: null</div>
<div class="line">              },</div>
<div class="line">              &quot;Channel&quot;: {</div>
<div class="line">                  &quot;description&quot;: &quot;Contains info about &#39;Channel Number&#39;&quot;,</div>
<div class="line">                  &quot;type&quot;: &quot;number&quot;</div>
<div class="line">              },</div>
<div class="line">              &quot;Mode&quot;: {</div>
<div class="line">                  &quot;description&quot;: &quot;Contains info about &#39;Mode&#39; Rx/Tx&quot;,</div>
<div class="line">                  &quot;type&quot;: &quot;number&quot;</div>
<div class="line">              },</div>
<div class="line">              &quot;Protocol&quot;: {</div>
<div class="line">                  &quot;description&quot;: &quot;Contains info about &#39;Protocol ID&#39;&quot;,</div>
<div class="line">                  &quot;type&quot;: &quot;number&quot;</div>
<div class="line">              },</div>
<div class="line">              &quot;Version&quot;: {</div>
<div class="line">                  &quot;description&quot;: &quot;Contains info about &#39;Version&#39;&quot;,</div>
<div class="line">                  &quot;type&quot;: &quot;number&quot;</div>
<div class="line">              },</div>
<div class="line">              &quot;ErrorCode&quot;: {</div>
<div class="line">                  &quot;description&quot;: &quot;Contains Error Code&quot;,</div>
<div class="line">                  &quot;type&quot;: &quot;number&quot;</div>
<div class="line">              },</div>
<div class="line">              &quot;Payload&quot;: {</div>
<div class="line">                  &quot;description&quot;: &quot;Raw Additional Data&quot;,</div>
<div class="line">                  &quot;type&quot;: &quot;array&quot;,</div>
<div class="line">                  &quot;items&quot;: {</div>
<div class="line">                      &quot;type&quot;: &quot;number&quot;</div>
<div class="line">                  },</div>
<div class="line">                  &quot;default&quot;: null</div>
<div class="line">              },</div>
<div class="line">          },</div>
<div class="line">          &quot;required&quot;: [</div>
<div class="line">              &quot;ErrorCode&quot;</div>
<div class="line">          ]</div>
<div class="line">      }</div>
<div class="line">  },</div>
<div class="line">  &quot;required&quot;: [</div>
<div class="line">      &quot;TimeStamp&quot;,</div>
<div class="line">      &quot;RawFrame&quot;</div>
<div class="line">  ]</div>
<div class="line">}</div>
</div><!-- fragment --><p>Example:</p>
<ul>
<li><code>ucl/UPTICap/1234567/TracePackage</code></li>
</ul>
<p>Without Additional Data</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    &quot;TimeStamp&quot;:&quot;2021-12-10T15:00:37.365671046+02:00&quot;,</div>
<div class="line">    &quot;RawFrame&quot;:[</div>
<div class="line">        91,54,0,2,0,170,90,113,84,5,0,42,0,135,248,204,219,103,182,83,55,133,34,128,42,51,117,171,63,222,252,0,1,18,45,45,104,82,110,164,167,85,34,97,12,2,187,63,235,250,209,1,1,22,81,93</div>
<div class="line">    ]</div>
<div class="line">}</div>
</div><!-- fragment --><p>With Additional Data </p><div class="fragment"><div class="line">{</div>
<div class="line">    &quot;TimeStamp&quot;: &quot;2021-12-10T15:07:51.426000339+02:00&quot;,</div>
<div class="line">    &quot;AdditionalData&quot;: {</div>
<div class="line">        &quot;Mode&quot;: &quot;RxSuccess&quot;,</div>
<div class="line">        &quot;Protocol&quot;: 6,</div>
<div class="line">        &quot;RadioConfig&quot;: 1,</div>
<div class="line">        &quot;Rssi&quot;: -5,</div>
<div class="line">        &quot;Channel&quot;: 2,</div>
<div class="line">        &quot;Speed&quot;: 0,</div>
<div class="line">        &quot;Syncword&quot;: [],</div>
<div class="line">        &quot;Version&quot;: 1,</div>
<div class="line">        &quot;ErrorCode&quot;: 0,</div>
<div class="line">        &quot;Payload&quot;: [</div>
<div class="line">            196,230,184,133,1,1,2,13,255,1,8,5,28</div>
<div class="line">        ]</div>
<div class="line">    },</div>
<div class="line">    &quot;RawFrame&quot;: [</div>
<div class="line">        91,33,0,2,0,10,222,80,110,5,0,42,0,170,248,196,230,184,133,1,1,2,13,255,1,8,5,28,249,45,1,2,6,81,93</div>
<div class="line">    ]</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md215"></a>
Installation</h1>
<p>Please refer to <a class="el" href="md_doc_readme_user.html">Unify SDK User guide</a>.</p>
<h1><a class="anchor" id="autotoc_md216"></a>
Running the UPTI CAP</h1>
<h2><a class="anchor" id="autotoc_md217"></a>
Using Systemd Service</h2>
<p>The best way to run the UPTI CAP is using the Systemd service that is installed with</p>
<p>the Debian installer. For more information, see <a class="el" href="md_doc_readme_user.html">Unify SDK User guide</a>.</p>
<h2><a class="anchor" id="autotoc_md218"></a>
Using Command Line</h2>
<p>Alternatively, you can run the UPTICAP by executing <code>uic-upti-cap</code>. You can configure the MQTT server, database path, through command line options. For details about options, run <code>uic-upti-cap --help</code> command:</p>
<p>Make sure that you do not run the UPTICAP both as a service and using the command line.</p>
<div class="fragment"><div class="line">pi@uic-upti-cap:~ $ service uic-upti-cap status</div>
<div class="line">● uic-upti-cap.service - Unified IoT UPTI cap</div>
<div class="line">   Loaded: loaded (/lib/systemd/system/uic-upti-cap.service; enabled; vendor preset: enabled)</div>
<div class="line">   Active: active (running) since Thu 2021-11-04 11:38:32 EET; 17min ago</div>
<div class="line"> Main PID: 1506 (uic-upti-cap)</div>
<div class="line">    Tasks: 3 (limit: 4915)</div>
<div class="line">   CGroup: /system.slice/uic-upti-cap.service</div>
<div class="line">           └─1506 /usr/bin/uic-upti-cap</div>
</div><!-- fragment --><p>If the service is running, stop it using the following command before you run the application manually:</p>
<div class="fragment"><div class="line">pi@unify:~ $ service uic-upti-cap stop</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Mar 23 2022 08:49:23 for Unify SDK User Guide by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>

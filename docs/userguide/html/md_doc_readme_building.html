<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Unify SDK User Guide: Unify Build Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Unify SDK User Guide
   &#160;<span id="projectnumber">1.1.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_doc_readme_building.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Unify Build Guide </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This document is intended for systems integrators who are trying to cross compile the Unify components. This guide explains how to build for a Raspberry Pi.</p>
<p>For a list a of build dependencies please refer to the <a href="../docker/Dockerfile">Dockerfile</a></p>
<h1><a class="anchor" id="autotoc_md82"></a>
Build Instructions</h1>
<p>The Unify SDK uses a docker container to provide an appropriate build environment. As a prerequisite docker must be installed on the build host. See <a class="el" href="md_docker_readme_developer.html">readme.md</a> for information about how to install docker and build the unify sdk environment.</p>
<p>Some Unify components require the Silabs Gecko SDK installed.</p>
<p>The Gecko SDK can be downloaded from GitHub [<a href="https://github.com/SiliconLabs/gecko_sdk/releases">https://github.com/SiliconLabs/gecko_sdk/releases</a>], select the file gecko-sdk.zip . Currently, v4.0.1 is the only supported version. Set an environment variable GSDK_LOCATION for this path.</p>
<h2><a class="anchor" id="autotoc_md83"></a>
Getting the source</h2>
<p>There are two ways to obtain the Unify source code, the simplest way is to download the file uic-&lt;version&gt;.tar.gz from the <a href="https://github.com/SiliconLabs/UnifySDK/releases">GitHub release assets</a>.</p>
<p>Alternatively the source can be downloaded using git directly. Note that git clients needs to have <em>git-lfs</em> support and the git client needs to have authentication with github.</p>
<div class="fragment"><div class="line">git@github.com:SiliconLabs/UnifySDK.git</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md84"></a>
Cross Compiling for Raspberry Pi Using Docker</h2>
<blockquote class="doxtable">
<p>The Raspberry Pi build is supported by Raspberry Pi OS Buster. </p>
</blockquote>
<p>To start start the docker with the unify build information run the following command from the root of the Unify source directory </p><div class="fragment"><div class="line">docker run -it --rm \</div>
<div class="line">  --env GSDK_LOCATION \</div>
<div class="line">  -v`pwd`:`pwd` \</div>
<div class="line">  -w `pwd` \</div>
<div class="line">  -v ${GSDK_LOCATION}:${GSDK_LOCATION} \</div>
<div class="line">  uic_armhf</div>
</div><!-- fragment --><p>Once the docker is started a new prompt will be shown. Building is done as follows: </p><div class="fragment"><div class="line">mkdir build</div>
<div class="line">cd build</div>
<div class="line">cmake -GNinja -DCMAKE_TOOLCHAIN_FILE=../cmake/armhf_debian.cmake ..</div>
<div class="line">ninja               # Build binaries</div>
<div class="line">ninja doxygen       # Build doxygen documentation (optional)</div>
<div class="line">ninja deb           # Build Debian Installers (optional)</div>
</div><!-- fragment --><p>After running this, the <code>zpc</code> binary is located in <code>./applications/zpc/zpc</code>. The Debian installer path are directly in the build folder <code>./uic-&lt;component&gt;_&lt;version&gt;_armhf.deb</code> and <code>./libuic_&lt;version&gt;_armhf.deb</code></p>
<h2><a class="anchor" id="autotoc_md85"></a>
Advanced Feature - Run Raspberry Pi Unit Tests in Docker on the Host</h2>
<p>The Unify unit tests can be run the Raspberry (and ZPC binary) within Docker on the Host machine by using QEMU to emulate the ARM architecture and binfmt in the kernel to tell the Linux OS to run the ARM binaries within QEMU.</p>
<p>To enable running the unit tests inside Docker on the Host machine, run the following command in the Host (not within the docker container).</p>
<div class="fragment"><div class="line">docker run --user 0 --privileged --rm -it uic_armhf update-binfmts --enable</div>
</div><!-- fragment --><blockquote class="doxtable">
<p>NB: This command needs to be run once after each restart of the Host machine. </p>
</blockquote>
<p>After enabling this unit tests can be run by issuing following command in the <code>uic_armhf</code> docker image in the build directory:</p>
<div class="fragment"><div class="line">ninja test</div>
<div class="line">ninja cargo_test</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md86"></a>
Porting the Unify SDK</h1>
<p>Porting the Unify SDK to new platform using Debian Linux should be straight forward. However, if components are ported to other Linux distributions it may be necessary to update the startup scripts of the components. The Debian packages provided with the Unify SDK all uses the system service <code>systemd</code> which takes care of startup and shutdown of the components. For example, the file <a href="applications/zpc/scripts/systemd/uic-zpc.service">uic-zpc.service</a> is as systemd config script. When porting to a new Linux system the systemd config files should be used for reference. It is very important that all the Unify components runs as a dedicated system user to prevent attackers from compromising the entire system. Also note that most components need write access to parts of the filesystem. The default path for writing files is <code>/var/lib/uic</code>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Mar 23 2022 08:49:23 for Unify SDK User Guide by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>

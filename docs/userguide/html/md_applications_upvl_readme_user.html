<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Unify SDK User Guide: UPVL User&#39;s Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Unify SDK User Guide
   &#160;<span id="projectnumber">1.0.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_applications_upvl_readme_user.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">UPVL User's Guide </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The <em>Unify SDK Provisioning List</em> (UPVL) MQTT Client is an application that manages the SmartStart List topic <code>ucl/SmartStart/List</code>.</p>
<p>The UPVL is required for all/any of the protocol controllers to support SmartStart.</p>
<p>It listens to the following MQTT topics, which is used to modify the SmartStart List and publish the list to <code>ucl/SmartStart/List</code> whenever it was updated:</p>
<ul>
<li><code>ucl/SmartStart/List/Update</code></li>
<li><code>ucl/SmartStart/List/Remove</code></li>
</ul>
<p>The SmartStart List is persisted in the file system by the UPVL and is published whenever the UPVL connects to the MQTT broker (i.e., when the UPVL or MQTT broker restarts, the persisted SmartStart list is published to <code>ucl/SmartStart/List</code>).</p>
<h1><a class="anchor" id="autotoc_md141"></a>
Running the UPVL</h1>
<h2><a class="anchor" id="autotoc_md142"></a>
Using Systemd Service</h2>
<p>The best way to run the UPVL is using the Systemd service that is installed with the Debian installer. For more information, see <a class="el" href="index.html#md_README">README.md</a>.</p>
<h2><a class="anchor" id="autotoc_md143"></a>
Using Command Line</h2>
<p>Alternatively, the UPVL may be run by executing <code>uic-upvl</code>. It is possible to configure the MQTT server, database path, through command line options. For more details about the options, run <code>uic-upvl --help</code>.</p>
<h2><a class="anchor" id="autotoc_md144"></a>
Output Examples</h2>
<div class="fragment"><div class="line">pi@rpi4ovdo1:~/demo $ ./uic-upvl --help</div>
<div class="line"> </div>
<div class="line">Usage: uic-upvl [Options]</div>
<div class="line"> </div>
<div class="line">Options:</div>
<div class="line">  --conf arg (=/etc/uic/uic.cfg)        Config file in YAML format</div>
<div class="line">  --help                                Print this help message and quit</div>
<div class="line">  --sample_conf_file                    Print sample YAML config file that can</div>
<div class="line">                                        be passed to --conf option</div>
<div class="line">  --version                             Print version information and quit</div>
<div class="line"> </div>
<div class="line">Following options can also be in a Config file.</div>
<div class="line"> Options and values passed on command line here take precedence over the options and values in config file:</div>
<div class="line">  --mqtt.host arg (=localhost)          MQTT broker hostname or IP</div>
<div class="line">  --mqtt.port arg (=1883)               MQTT broker port</div>
<div class="line">  --mqtt.cafile arg                     Path to file containing the PEM encoded</div>
<div class="line">                                        CA certificate to connect to Mosquitto</div>
<div class="line">                                        MQTT broker for TLS encryption</div>
<div class="line">  --mqtt.certfile arg                   Path to file containing the PEM encoded</div>
<div class="line">                                        client certificate to connect to</div>
<div class="line">                                        Mosquitto MQTT broker for TLS</div>
<div class="line">                                        encryption</div>
<div class="line">  --mqtt.keyfile arg                    Path to file containing the PEM encoded</div>
<div class="line">                                        CA certificate to connect to Mosquitto</div>
<div class="line">                                        MQTT broker for TLS encryption</div>
<div class="line">  --log.level arg (=d)                  Log Level (d,i,w,e,c)</div>
<div class="line">  --log.tag_level arg                   Tag based log level</div>
<div class="line">                                        Format: &lt;tag&gt;:&lt;severity&gt;,</div>
<div class="line">                                        &lt;tag&gt;:&lt;severity&gt;, ...</div>
<div class="line">  --datastore.file arg (=/var/lib/uic/database.db)</div>
<div class="line">                                        Datastore database file</div>
<div class="line">  --mqtt.client_id arg (=upvl_client)   Client ID for MQTT client</div>
<div class="line">  --upvl.db_file arg (=upvl_test.db)    File name of UPVL database</div>
</div><!-- fragment --><div class="fragment"><div class="line">pi@rpi4ovdo1:~/demo $ ./uic-upvl --conf ./upvl.conf</div>
<div class="line">MQTT broker from config 192.168.1.209</div>
<div class="line">MQTT port number from config 1883</div>
<div class="line">UPVL DB filename from config upvl_database.db</div>
<div class="line">Logging level from config c,i,e</div>
<div class="line">2021-02-10 18:19:52:301949 &lt;i&gt; [upvl_db] Using database file upvl_database.db</div>
<div class="line">2021-02-10 18:19:52:475877 &lt;i&gt; [upvl_mqtt] Connected to broker on 192.168.1.209 port 1883</div>
<div class="line">2021-02-10 18:19:52:476183 &lt;i&gt; [upvl_db] To publish: []</div>
<div class="line">2021-02-10 18:19:52:477271 &lt;i&gt; [upvl_mqtt] (Re-)connected to broker</div>
<div class="line">2021-02-10 18:19:52:477344 &lt;i&gt; [upvl_mqtt] Subscribing</div>
<div class="line">2021-02-10 18:21:36:284275 &lt;i&gt; [upvl_mqtt] Subscriber: Received upvl topic &quot;ucl/SmartStart/List/Update&quot;</div>
<div class="line">2021-02-10 18:21:36:297850 &lt;i&gt; [upvl_db] Updated DB for DSK 20434-14882-53263-05030-45268-50517-20518-60286.</div>
<div class="line">2021-02-10 18:21:36:298437 &lt;i&gt; [upvl_db] To publish: [{&quot;DSK&quot;:&quot;20434-14882-53263-05030-45268-50517-20518-60286&quot;,&quot;Include&quot;:true,&quot;ProtocolControllerUnid&quot;:&quot;&quot;,&quot;Unid&quot;:&quot;&quot;}]</div>
<div class="line">2021-02-10 18:21:36:298810 &lt;i&gt; [upvl_mqtt] Publisher: Published message with id: 4</div>
<div class="line">2021-02-10 18:21:57:483021 &lt;i&gt; [upvl_mqtt] Subscriber: Received upvl topic &quot;ucl/SmartStart/List/Update&quot;</div>
<div class="line">2021-02-10 18:21:57:496147 &lt;i&gt; [upvl_db] Updated DB for DSK 20434-14882-53263-05030-45268-50517-20518-60287.</div>
<div class="line">2021-02-10 18:21:57:496719 &lt;i&gt; [upvl_db] To publish: [{&quot;DSK&quot;:&quot;20434-14882-53263-05030-45268-50517-20518-60286&quot;,&quot;Include&quot;:true,&quot;ProtocolControllerUnid&quot;:&quot;&quot;,&quot;Unid&quot;:&quot;&quot;},{&quot;DSK&quot;:&quot;20434-14882-53263-05030-45268-50517-20518-60287&quot;,&quot;Include&quot;:true,&quot;ProtocolControllerUnid&quot;:&quot;&quot;,&quot;Unid&quot;:&quot;&quot;}]</div>
<div class="line">2021-02-10 18:21:57:497101 &lt;i&gt; [upvl_mqtt] Publisher: Published message with id: 5</div>
<div class="line">2021-02-10 18:22:57:815468 &lt;i&gt; [upvl_mqtt] Subscriber: Received upvl topic &quot;ucl/SmartStart/List/Remove&quot;</div>
<div class="line">2021-02-10 18:22:57:815696 &lt;E&gt; [upvl_mqtt] Cannot convert payload to json, error trailing comma at line 3 column 1</div>
<div class="line">2021-02-10 18:23:21:914602 &lt;i&gt; [upvl_mqtt] Subscriber: Received upvl topic &quot;ucl/SmartStart/List/Remove&quot;</div>
<div class="line">2021-02-10 18:23:21:928011 &lt;i&gt; [upvl_db] Removed 1 entries with DSK 20434-14882-53263-05030-45268-50517-20518-60287.</div>
<div class="line">2021-02-10 18:23:21:928563 &lt;i&gt; [upvl_db] To publish: [{&quot;DSK&quot;:&quot;20434-14882-53263-05030-45268-50517-20518-60286&quot;,&quot;Include&quot;:true,&quot;ProtocolControllerUnid&quot;:&quot;&quot;,&quot;Unid&quot;:&quot;&quot;}]</div>
<div class="line">2021-02-10 18:23:21:929022 &lt;i&gt; [upvl_mqtt] Publisher: Published message with id: 6</div>
<div class="line">2021-02-10 18:23:31:265982 &lt;i&gt; [upvl_mqtt] Subscriber: Received upvl topic &quot;ucl/SmartStart/List/Remove&quot;</div>
<div class="line">2021-02-10 18:23:31:278848 &lt;i&gt; [upvl_db] Removed 1 entries with DSK 20434-14882-53263-05030-45268-50517-20518-60286.</div>
<div class="line">2021-02-10 18:23:31:279392 &lt;i&gt; [upvl_db] To publish: []</div>
<div class="line">2021-02-10 18:23:31:279759 &lt;i&gt; [upvl_mqtt] Publisher: Published message with id: 7</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Nov 5 2021 19:42:07 for Unify SDK User Guide by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>

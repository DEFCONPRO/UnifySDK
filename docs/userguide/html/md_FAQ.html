<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Unify SDK User Guide: Unify FAQ</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Unify SDK User Guide
   &#160;<span id="projectnumber">1.1.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_FAQ.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Unify FAQ </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li><p class="startli"><em>How can I see if the Unify components are running?</em></p>
<p class="startli">Unify applications are running as Linux <code>systemd</code> services. To get a status overview of all installed Unify components, run the following command:</p>
</li>
</ul>
<div class="fragment"><div class="line">systemctl status `ls /lib/systemd/system/uic-*.service | xargs -n 1 basename`</div>
</div><!-- fragment --><p>The output of this command will tell if the service is loaded and/or is active:</p>
<div class="fragment"><div class="line">- uic-dev-gui-api.service - Unify User Interface API</div>
<div class="line">  Loaded: loaded (/lib/systemd/system/uic-dev-gui-api.service; enabled; vendor preset: enabled)</div>
<div class="line">  Active: active (running) since Sun 2021-07-25 12:17:05 BST; 21min ago</div>
</div><!-- fragment --><ul>
<li><p class="startli"><em>How do I get logging of a specific Unify component?</em></p>
<p class="startli">Logging is collected via Linux <code>systemd</code>. In the terminal <code>journalctl</code> is able to print the collected logs from all Unify components. Getting the log of, for instance <code>uic-upvl</code>, is done via command:</p>
</li>
</ul>
<div class="fragment"><div class="line">journalctl -u uic-upvl</div>
</div><!-- fragment --><ul>
<li><p class="startli"><em>How do I clear Unify caches and databases?</em></p>
<p class="startli">Execute the following command in a terminal on the Unify gateway:</p>
</li>
</ul>
<div class="fragment"><div class="line">unify_services=`ls /lib/systemd/system/uic-*.service | xargs -n 1 basename`; sudo systemctl stop mosquitto $unify_services &amp;&amp; sudo rm /var/lib/mosquitto/mosquitto.db /var/lib/uic/zpc.db /var/lib/uic/zigpc.db /var/lib/uic/upvl.db &amp;&amp; sudo systemctl start mosquitto $unify_services</div>
</div><!-- fragment --><p>&gt;Note: database paths can vary depending on your configuration</p>
<ul>
<li><em>I cant access the Dev UI/ the Dev UI is not responding anymore!</em><ol type="1">
<li>Test if the gateway can still be reached over TCP/IP. Ping the ip address of the gateway.</li>
<li>Open a terminal on the Unify gateway, check the current status of the <code>uic-dev-gui-api</code> and <code>uic-dev-gui-client</code>. (See previous questions how to print the status)</li>
<li><p class="startli">If status is inactive, restart the UI:</p>
<p class="startli">``` sh sudo systemctl restart uic-dev-gui-* ```</p>
</li>
</ol>
</li>
<li><em>My Z-Wave device doesn't seem to include with my gateway</em><ol type="1">
<li><p class="startli">Make sure your device and gateway match frequency region. i.e., an EU device is incompatible with an US gateway. Information of the region can be find on the packaging of the device.</p>
<p class="startli">To verify the rf region on your gateway, execute the following command in your gateway terminal:</p>
<p class="startli">``` sh cat /etc/uic/uic.cfg ```</p>
<p class="startli">It outputs the configured rf_region:</p>
<p class="startli">```bash pi@raspberrypi:/etc/uic $ cat uic.cfg zpc: serial: /dev/ttyUSB0 rf_region: US datatore_file: /var/lib/uic/zpc.db ```</p>
</li>
<li>Make sure your device isn't still connected to a previous network. To remove a previous inclusion, hit the action button on your product and put the gateway in remove state.</li>
<li>Power-cycling your device could make it to include.</li>
<li>To change the frequency region of the gateway, see the startup options for the ZPC.</li>
</ol>
</li>
<li><em>The gateway doesn't respond anymore!</em><ol type="1">
<li>It could be that the gateway experiences some delays while communicating with the Z-Wave node (missing Acknowledgment/Report, routing issues...). In this case, it may look like the gateway does not react to IoT Services commands. You could verify that the gateway still responds by modifying the state of another Z-Wave device in the gateway and see if the gateway responds to these changes. A way to modify state is to open MQTT explorer and to publish a command to a cluster for a particular node.</li>
<li>As last resort, try to restart the Unify gateway.</li>
</ol>
</li>
<li><p class="startli"><em>How do I run the ZPC in isolation?</em></p>
<p class="startli">Stop the ZPC systemd service:</p>
</li>
</ul>
<div class="fragment"><div class="line">sudo systemctl stop uic-zpc</div>
</div><!-- fragment --><p>run:</p>
<div class="fragment"><div class="line">/usr/bin/zpc --zpc.serial /dev/ttyUSB0</div>
</div><!-- fragment --><p>Replace the serial argument with the port the Z-Wave controller is connected to.</p>
<ul>
<li><p class="startli"><em>I have an old Z-Wave device, is it still supported?</em></p>
<p class="startli">Yes. However, older devices may be inconsistent in reporting their actual state. This usually means that operating the same command for a second time, the state get updated correctly.</p>
</li>
<li><p class="startli"><em>Can I get detailed diagnostics about devices, its clusters and the network?</em></p>
<p class="startli">Using application <a href="http://mqtt-explorer.com"><code>mqtt explorer</code></a> can give more insights in your Unify network.</p>
</li>
<li><p class="startli"><em>How do I determine the root cause for my failed firmware update?</em></p>
<p class="startli">The lastError field in the OTA tab of the dev_gui is giving a rough error code. The logging of the uic-zpc usually gives a more detailed explanation of the reason why a firmware update is not accepted.</p>
</li>
<li><p class="startli"><em>My device shows up with more clusters than expected!</em></p>
<p class="startli">This is intended behavior. A protocol cluster can overlap in functionality with multiple UCL clusters. Rather then mapping to one, The Unify gateway exposes the protocol cluster to multiple clusters.</p>
</li>
<li><p class="startli"><em>Can't connect 3rd party MQTT client to my device</em></p>
<p class="startli">This is because the Mosquitto broker by-default requires authentication and doesnâ€™t listen on a network address. To change this behavior, create a file <code>/etc/mosquitto/conf.d/open_access.conf</code> and fill it with:</p>
</li>
</ul>
<div class="fragment"><div class="line">listener 1883</div>
<div class="line">allow_anonymous true</div>
</div><!-- fragment --><p>Read more <a href="http://www.steves-internet-guide.com/mosquitto-broker/">here</a>.</p>
<h2><a class="anchor" id="autotoc_md25"></a>
Development</h2>
<ul>
<li><p class="startli"><em>Is mac supported for developing?</em></p>
<p class="startli">Our software should build and run on a mac machine. However, it is not officially supported.</p>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md26"></a>
ZPC</h2>
<ul>
<li><p class="startli"><em>ZPC complains about var/lib/uic/zpc.db permissions, How do I fix it?</em></p>
<p class="startli">This means your probably running the ZPC as an executable and not as a <code>systemd</code> service. Advised is to run ZPC with a database path that is writable in this case:</p>
</li>
</ul>
<div class="fragment"><div class="line">/usr/bin/zpc --zpc.datastore_file ~/zpc.db</div>
</div><!-- fragment --><ul>
<li><em>Inclusion of a device keeps failing</em> try to reset the UPVL database:</li>
</ul>
<div class="fragment"><div class="line">sudo systemctl stop uic-upvl &amp;&amp; rm /var/lib/uic/upvl.db &amp;&amp; sudo systemctl start uic-upvl</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md27"></a>
Known issues and fixes</h1>
<h2><a class="anchor" id="autotoc_md28"></a>
Windows (git Bash)</h2>
<h3><a class="anchor" id="autotoc_md29"></a>
"winpty" issue</h3>
<div class="fragment"><div class="line">user@winmachine MINGW64 ~/path/to/UnifySDK (main)</div>
<div class="line">$ docker run -it --rm  -v`pwd`:`pwd` -w `pwd` uic_armhf</div>
<div class="line">the input device is not a TTY.  If you are using mintty, try prefixing the command with &#39;winpty&#39;</div>
</div><!-- fragment --><p>Workaround: add a <code>winpty</code> prefix to the command:</p>
<div class="fragment"><div class="line">winpty docker run -it --rm  -v`pwd`:`pwd` -w `pwd` uic_armhf</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md30"></a>
The "Docker directory path" issue</h3>
<div class="fragment"><div class="line">user@winmachine MINGW64 ~/path/to/UnifySDK (main)</div>
<div class="line">$ winpty docker run -it --rm  -v`pwd`:`pwd` -w `pwd` uic_armhf</div>
<div class="line">docker: Error response from daemon: the working directory &#39;C:/path/to/UnifySDK&#39; is invalid, it needs to be an absolute path.</div>
<div class="line">See &#39;docker run --help&#39;.</div>
</div><!-- fragment --><p>Workarround: add the <code>/</code> symbol before <code>pwd</code>:</p>
<div class="fragment"><div class="line">user@winmachine MINGW64 ~/path/to/UnifySDK (main)</div>
<div class="line">$ winpty docker run -it --rm  -v/`pwd`:/`pwd` -w /`pwd` uic_armhf</div>
<div class="line">user@dockercontainer:/c/path/to/UnifySDK$</div>
</div><!-- fragment --><p>Explanation: <a href="https://stackoverflow.com/questions/40213524/using-absolute-path-with-docker-run-command-not-working#comment109755641_40214650">link</a>.</p>
<h3><a class="anchor" id="autotoc_md31"></a>
The "CRLF" issue</h3>
<p>After running <code>ninja</code> inside the Docker container you may explore a lot of &lsquo;expected primary expression before 'case:&rsquo;` errors. This is because of Windows line endings (CRLF vs Linux's CR-only).</p>
<p>Workarround: run in your repository folder</p>
<div class="fragment"><div class="line">git config --global core.autocrlf input</div>
<div class="line">git rm --cached -r .</div>
<div class="line">git reset --hard</div>
</div><!-- fragment --><p>Explanations: <a href="https://stackoverflow.com/questions/1967370/git-replacing-lf-with-crlf">link</a>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Mar 23 2022 08:49:23 for Unify SDK User Guide by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Unify Specification: Message Security</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Unify Specification
   &#160;<span id="projectnumber">ver1_0_RC11_20211006-12-g5cdaf55</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Message Security </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This chapter describes how to manage message security crossing from one MQTT client (PHY Protocol Controller or Cloud Service) to another.</p>
<h1><a class="anchor" id="autotoc_md141"></a>
Security Scale for Messages</h1>
<p>PHY translators MUST annotate MQTT publish messages triggered by incoming PAN frame. The annotation must indicate the incoming security level of the PAN frame. The annotation must use a scale that enumerates all the security modes in all the translated PHYs, ranked by security level. For example, the Z-Wave S2 Authenticated and BLE Diffie-Hellman inclusion methods must be placed appropriately on the same scale. The security scale must be extensible to add more PHYs of both high and low security levels. The security level MUST NOT be used for outgoing frames towards a PHY. The security field is for incoming security level only.</p>
<h1><a class="anchor" id="autotoc_md142"></a>
Requirements</h1>
<p>The ACL engine must admit only MQTT publishes from a given MQTT Client (PHY Translator or IoT Service alike) with security levels that PHY Translator is trusted to manage. For example, a completely non-secure X10 PHY Translator should never be allowed to publish a Security 2 Authenticated level message. The highest security level allowed for an MQTT client may be hard coded in the ACL configuration or derived from a certificate presented by the MQTT client. A PHY translator must never upgrade security on PAN Frames. If necessary, it must publish the frame on the PAN side with a less secure security level. The PHY translator may drop an outgoing frame to the PAN, if it can guarantee that the frame will not be processed by the node due to the security level in use. The Security Level must be published per-node by a PHY Translator to support PHYs where individual nodes may have different security levels. The ACL engine will monitor the node status topic to detect the security level supported by a node. Likewise, a rules engine must check the affected nodes security status fields before accepting a rule.</p>
<h1><a class="anchor" id="autotoc_md143"></a>
Automatic Selection of PAN Security Level</h1>
<p>Security levels of messages egressing the broker into a PAN MUST be chosen by the PHY Translator. The PHY Translator must choose the appropriate security level based on knowledge on the specific PHY. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>

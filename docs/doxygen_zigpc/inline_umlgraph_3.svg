<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1133px" preserveAspectRatio="none" style="width:986px;height:1133px;background:#FFFFFF;" version="1.1" viewBox="0 0 986 1133" width="986px" zoomAndPan="magnify"><defs><filter height="300%" id="fnkoypq2m9jnh" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="243" x="389.5" y="28.708">ZigPC Discovery Behaviour</text><rect fill="#FFC0CB" filter="url(#fnkoypq2m9jnh)" height="660.125" style="stroke:#000000;stroke-width:2.0;" width="959" x="8" y="442.3125"/><rect fill="#FFFFFF" height="564.7266" style="stroke:none;stroke-width:1.0;" width="959" x="8" y="537.7109"/><rect fill="#FFFFFF" filter="url(#fnkoypq2m9jnh)" height="357.0625" style="stroke:#000000;stroke-width:2.0;" width="915" x="27" y="633.9766"/><rect fill="#FFC0CB" filter="url(#fnkoypq2m9jnh)" height="187.6641" style="stroke:#000000;stroke-width:2.0;" width="871" x="46" y="789.375"/><rect fill="#FFFFFF" height="92.2656" style="stroke:none;stroke-width:1.0;" width="871" x="46" y="884.7734"/><line style="stroke:#A80036;stroke-width:1.0;" x1="62" x2="62" y1="75.25" y2="227.7813"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="62" x2="62" y1="227.7813" y2="255.7813"/><line style="stroke:#A80036;stroke-width:1.0;" x1="62" x2="62" y1="255.7813" y2="314.0469"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="62" x2="62" y1="314.0469" y2="342.0469"/><line style="stroke:#A80036;stroke-width:1.0;" x1="62" x2="62" y1="342.0469" y2="410.3125"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="62" x2="62" y1="410.3125" y2="438.3125"/><line style="stroke:#A80036;stroke-width:1.0;" x1="62" x2="62" y1="438.3125" y2="529.7109"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="62" x2="62" y1="529.7109" y2="557.7109"/><line style="stroke:#A80036;stroke-width:1.0;" x1="62" x2="62" y1="557.7109" y2="601.9766"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="62" x2="62" y1="601.9766" y2="629.9766"/><line style="stroke:#A80036;stroke-width:1.0;" x1="62" x2="62" y1="629.9766" y2="661.1094"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="62" x2="62" y1="661.1094" y2="689.1094"/><line style="stroke:#A80036;stroke-width:1.0;" x1="62" x2="62" y1="689.1094" y2="757.375"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="62" x2="62" y1="757.375" y2="785.375"/><line style="stroke:#A80036;stroke-width:1.0;" x1="62" x2="62" y1="785.375" y2="876.7734"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="62" x2="62" y1="876.7734" y2="904.7734"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="62" x2="62" y1="904.7734" y2="932.7734"/><line style="stroke:#A80036;stroke-width:1.0;" x1="62" x2="62" y1="932.7734" y2="1126.4375"/><line style="stroke:#A80036;stroke-width:1.0;" x1="151" x2="151" y1="75.25" y2="227.7813"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="151" x2="151" y1="227.7813" y2="255.7813"/><line style="stroke:#A80036;stroke-width:1.0;" x1="151" x2="151" y1="255.7813" y2="314.0469"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="151" x2="151" y1="314.0469" y2="342.0469"/><line style="stroke:#A80036;stroke-width:1.0;" x1="151" x2="151" y1="342.0469" y2="410.3125"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="151" x2="151" y1="410.3125" y2="438.3125"/><line style="stroke:#A80036;stroke-width:1.0;" x1="151" x2="151" y1="438.3125" y2="529.7109"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="151" x2="151" y1="529.7109" y2="557.7109"/><line style="stroke:#A80036;stroke-width:1.0;" x1="151" x2="151" y1="557.7109" y2="601.9766"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="151" x2="151" y1="601.9766" y2="629.9766"/><line style="stroke:#A80036;stroke-width:1.0;" x1="151" x2="151" y1="629.9766" y2="661.1094"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="151" x2="151" y1="661.1094" y2="689.1094"/><line style="stroke:#A80036;stroke-width:1.0;" x1="151" x2="151" y1="689.1094" y2="757.375"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="151" x2="151" y1="757.375" y2="785.375"/><line style="stroke:#A80036;stroke-width:1.0;" x1="151" x2="151" y1="785.375" y2="876.7734"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="151" x2="151" y1="876.7734" y2="904.7734"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="151" x2="151" y1="904.7734" y2="932.7734"/><line style="stroke:#A80036;stroke-width:1.0;" x1="151" x2="151" y1="932.7734" y2="1126.4375"/><line style="stroke:#A80036;stroke-width:1.0;" x1="542" x2="542" y1="75.25" y2="227.7813"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="542" x2="542" y1="227.7813" y2="255.7813"/><line style="stroke:#A80036;stroke-width:1.0;" x1="542" x2="542" y1="255.7813" y2="314.0469"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="542" x2="542" y1="314.0469" y2="342.0469"/><line style="stroke:#A80036;stroke-width:1.0;" x1="542" x2="542" y1="342.0469" y2="410.3125"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="542" x2="542" y1="410.3125" y2="438.3125"/><line style="stroke:#A80036;stroke-width:1.0;" x1="542" x2="542" y1="438.3125" y2="529.7109"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="542" x2="542" y1="529.7109" y2="557.7109"/><line style="stroke:#A80036;stroke-width:1.0;" x1="542" x2="542" y1="557.7109" y2="601.9766"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="542" x2="542" y1="601.9766" y2="629.9766"/><line style="stroke:#A80036;stroke-width:1.0;" x1="542" x2="542" y1="629.9766" y2="661.1094"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="542" x2="542" y1="661.1094" y2="689.1094"/><line style="stroke:#A80036;stroke-width:1.0;" x1="542" x2="542" y1="689.1094" y2="757.375"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="542" x2="542" y1="757.375" y2="785.375"/><line style="stroke:#A80036;stroke-width:1.0;" x1="542" x2="542" y1="785.375" y2="876.7734"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="542" x2="542" y1="876.7734" y2="904.7734"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="542" x2="542" y1="904.7734" y2="932.7734"/><line style="stroke:#A80036;stroke-width:1.0;" x1="542" x2="542" y1="932.7734" y2="1126.4375"/><line style="stroke:#A80036;stroke-width:1.0;" x1="901" x2="901" y1="75.25" y2="227.7813"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="901" x2="901" y1="227.7813" y2="255.7813"/><line style="stroke:#A80036;stroke-width:1.0;" x1="901" x2="901" y1="255.7813" y2="314.0469"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="901" x2="901" y1="314.0469" y2="342.0469"/><line style="stroke:#A80036;stroke-width:1.0;" x1="901" x2="901" y1="342.0469" y2="410.3125"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="901" x2="901" y1="410.3125" y2="438.3125"/><line style="stroke:#A80036;stroke-width:1.0;" x1="901" x2="901" y1="438.3125" y2="529.7109"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="901" x2="901" y1="529.7109" y2="557.7109"/><line style="stroke:#A80036;stroke-width:1.0;" x1="901" x2="901" y1="557.7109" y2="601.9766"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="901" x2="901" y1="601.9766" y2="629.9766"/><line style="stroke:#A80036;stroke-width:1.0;" x1="901" x2="901" y1="629.9766" y2="661.1094"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="901" x2="901" y1="661.1094" y2="689.1094"/><line style="stroke:#A80036;stroke-width:1.0;" x1="901" x2="901" y1="689.1094" y2="757.375"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="901" x2="901" y1="757.375" y2="785.375"/><line style="stroke:#A80036;stroke-width:1.0;" x1="901" x2="901" y1="785.375" y2="876.7734"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="901" x2="901" y1="876.7734" y2="904.7734"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="901" x2="901" y1="904.7734" y2="932.7734"/><line style="stroke:#A80036;stroke-width:1.0;" x1="901" x2="901" y1="932.7734" y2="1126.4375"/><rect fill="#FEFECE" filter="url(#fnkoypq2m9jnh)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="69" x="25.5" y="39.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="32.5" y="59.9482">Listener</text><rect fill="#FEFECE" filter="url(#fnkoypq2m9jnh)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="81" x="108.5" y="39.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="115.5" y="59.9482">Controller</text><rect fill="#FEFECE" filter="url(#fnkoypq2m9jnh)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="126" x="477" y="39.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="484" y="59.9482">ZigPC Discovery</text><rect fill="#FEFECE" filter="url(#fnkoypq2m9jnh)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="118" x="840" y="39.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104" x="847" y="59.9482">ZigPC Gateway</text><rect fill="#EEEEEE" filter="url(#fnkoypq2m9jnh)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="971" x="5" y="103.8164"/><line style="stroke:#000000;stroke-width:1.0;" x1="5" x2="976" y1="103.8164" y2="103.8164"/><line style="stroke:#000000;stroke-width:1.0;" x1="5" x2="976" y1="106.8164" y2="106.8164"/><rect fill="#EEEEEE" filter="url(#fnkoypq2m9jnh)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="337" x="322" y="93.25"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="318" x="328" y="109.3169">Register p_listener (for all device updates)</text><polygon fill="#A80036" points="530,143.5156,540,147.5156,530,151.5156,534,147.5156" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="62" x2="536" y1="147.5156" y2="147.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193" x="69" y="142.4497">add_listener(listener_callback)</text><rect fill="#EEEEEE" filter="url(#fnkoypq2m9jnh)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="971" x="5" y="176.082"/><line style="stroke:#000000;stroke-width:1.0;" x1="5" x2="976" y1="176.082" y2="176.082"/><line style="stroke:#000000;stroke-width:1.0;" x1="5" x2="976" y1="179.082" y2="179.082"/><rect fill="#EEEEEE" filter="url(#fnkoypq2m9jnh)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="435" x="273" y="165.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="416" x="279" y="181.5825">Start Interview with callback (for single device updates)</text><polygon fill="#A80036" points="530,215.7813,540,219.7813,530,223.7813,534,219.7813" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="151" x2="536" y1="219.7813" y2="219.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="288" x="158" y="214.7153">interview_device(EUI64_X,controller_callback)</text><polygon fill="#A80036" points="162,272.9141,152,276.9141,162,280.9141,158,276.9141" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="156" x2="541" y1="276.9141" y2="276.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="308" x="168" y="271.8481">controller_callback(EUI64_X, DISCOVERY_START)</text><polygon fill="#A80036" points="73,302.0469,63,306.0469,73,310.0469,69,306.0469" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="67" x2="541" y1="306.0469" y2="306.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="295" x="79" y="300.981">listener_callback(EUI64_X, DISCOVERY_START)</text><path d="M425.5,347.0469 L425.5,372.0469 L654.5,372.0469 L654.5,357.0469 L644.5,347.0469 L425.5,347.0469 " fill="#FBFB77" filter="url(#fnkoypq2m9jnh)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M644.5,347.0469 L644.5,357.0469 L654.5,357.0469 L644.5,347.0469 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208" x="431.5" y="364.1138">Discover endpoints under device</text><polygon fill="#A80036" points="889,398.3125,899,402.3125,889,406.3125,893,402.3125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="542" x2="895" y1="402.3125" y2="402.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="268" x="549" y="397.2466">Send DiscoverDevice Request for EUI64_X</text><path d="M8,442.3125 L72,442.3125 L72,449.3125 L62,459.3125 L8,459.3125 L8,442.3125 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="660.125" style="stroke:#000000;stroke-width:2.0;" width="959" x="8" y="442.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="23" y="455.3794">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="171" x="87" y="454.5229">[DeviceDiscovery Timeout]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="8" x2="967" y1="538.7109" y2="538.7109"/><polygon fill="#A80036" points="162,486.5781,152,490.5781,162,494.5781,158,490.5781" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="156" x2="541" y1="490.5781" y2="490.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="348" x="168" y="485.5122">controller_callback(EUI64_X, DEVICE_DISCOVERY_FAIL)</text><polygon fill="#A80036" points="73,515.7109,63,519.7109,73,523.7109,69,519.7109" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="67" x2="541" y1="519.7109" y2="519.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="335" x="79" y="514.645">listener_callback(EUI64_X, DEVICE_DISCOVERY_FAIL)</text><polygon fill="#A80036" points="553,589.9766,543,593.9766,553,597.9766,549,593.9766" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="547" x2="900" y1="593.9766" y2="593.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="294" x="559" y="573.7778">Receive DiscoverDevice Response for EUI64_X</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="563" y="588.9106">ActiveEndpointList: [1,2,3]</text><path d="M27,633.9766 L104,633.9766 L104,640.9766 L94,650.9766 L27,650.9766 L27,633.9766 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="357.0625" style="stroke:#000000;stroke-width:2.0;" width="915" x="27" y="633.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32" x="42" y="647.0435">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="187" x="119" y="646.187">[for EP in ActiveEndpointList]</text><path d="M404.5,694.1094 L404.5,719.1094 L675.5,719.1094 L675.5,704.1094 L665.5,694.1094 L404.5,694.1094 " fill="#FBFB77" filter="url(#fnkoypq2m9jnh)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M665.5,694.1094 L665.5,704.1094 L675.5,704.1094 L665.5,694.1094 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="250" x="410.5" y="711.1763">Discover clusters under EP sequentially</text><polygon fill="#A80036" points="889,745.375,899,749.375,889,753.375,893,749.375" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="542" x2="895" y1="749.375" y2="749.375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="305" x="549" y="744.3091">Send DiscoverEndpoint Request for EUI64_X::EP</text><path d="M46,789.375 L110,789.375 L110,796.375 L100,806.375 L46,806.375 L46,789.375 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="187.6641" style="stroke:#000000;stroke-width:2.0;" width="871" x="46" y="789.375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="61" y="802.4419">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="185" x="125" y="801.5854">[EndpointDiscovery Timeout]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="46" x2="917" y1="885.7734" y2="885.7734"/><polygon fill="#A80036" points="162,833.6406,152,837.6406,162,841.6406,158,837.6406" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="156" x2="541" y1="837.6406" y2="837.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="367" x="168" y="832.5747">controller_callback(EUI64_X, ENDPOINT_DISCOVERY_FAIL)</text><polygon fill="#A80036" points="73,862.7734,63,866.7734,73,870.7734,69,866.7734" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="67" x2="541" y1="866.7734" y2="866.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="354" x="79" y="861.7075">listener_callback(EUI64_X, ENDPOINT_DISCOVERY_FAIL)</text><polygon fill="#A80036" points="553,965.0391,543,969.0391,553,973.0391,549,969.0391" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="547" x2="900" y1="969.0391" y2="969.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="331" x="559" y="948.8403">Receive EndpointDiscover Response for EUI64_X::EP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="278" x="563" y="963.9731">{serverClusters: [1,4,6], clientClusters: [4]}</text><path d="M383,1010.0391 L383,1035.0391 L697,1035.0391 L697,1020.0391 L687,1010.0391 L383,1010.0391 " fill="#FBFB77" filter="url(#fnkoypq2m9jnh)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M687,1010.0391 L687,1020.0391 L697,1020.0391 L687,1010.0391 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="293" x="389" y="1027.106">All Endpoints Discovered, Discovery Complete</text><polygon fill="#A80036" points="162,1061.3047,152,1065.3047,162,1069.3047,158,1065.3047" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="156" x2="541" y1="1065.3047" y2="1065.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="331" x="168" y="1060.2388">controller_callback(EUI64_X, DISCOVERY_SUCCESS)</text><polygon fill="#A80036" points="73,1090.4375,63,1094.4375,73,1098.4375,69,1094.4375" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="67" x2="541" y1="1094.4375" y2="1094.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="318" x="79" y="1089.3716">listener_callback(EUI64_X, DISCOVERY_SUCCESS)</text><!--MD5=[699b30db6bdbcf90516ef5ddbfb6ff7a]
@startuml inline_umlgraph_3.svg
!pragma teoz true
participant "Listener" as p_listener
participant "Controller" as p_controller
participant "ZigPC Discovery" as p_discovery
participant "ZigPC Gateway" as p_gateway
hide footbox
title "ZigPC Discovery Behaviour"
== Register p_listener (for all device updates) ==
p_listener -> p_discovery: add_listener(listener_callback)
== Start Interview with callback (for single device updates) ==
p_controller -> p_discovery: interview_device(EUI64_X,controller_callback)
...
p_controller <- p_discovery: controller_callback(EUI64_X, DISCOVERY_START)
p_listener <- p_discovery: listener_callback(EUI64_X, DISCOVERY_START)
...
note over p_discovery
Discover endpoints under device
end note
p_discovery -> p_gateway: Send DiscoverDevice Request for EUI64_X
...
alt #pink DeviceDiscovery Timeout
  p_controller <- p_discovery: controller_callback(EUI64_X, DEVICE_DISCOVERY_FAIL)
  p_listener <- p_discovery: listener_callback(EUI64_X, DEVICE_DISCOVERY_FAIL)
else #white
  ...
  p_discovery <- p_gateway: Receive DiscoverDevice Response for EUI64_X \n ActiveEndpointList: [1,2,3]
  ...
  loop for EP in ActiveEndpointList
    ...
    note over p_discovery
    Discover clusters under EP sequentially
    end note
    p_discovery -> p_gateway: Send DiscoverEndpoint Request for EUI64_X::EP
    ...
    alt #pink EndpointDiscovery Timeout
      p_controller <- p_discovery: controller_callback(EUI64_X, ENDPOINT_DISCOVERY_FAIL)
      p_listener <- p_discovery: listener_callback(EUI64_X, ENDPOINT_DISCOVERY_FAIL)
    else #white
      ...
      ...
      p_discovery <- p_gateway: Receive EndpointDiscover Response for EUI64_X::EP \n {serverClusters: [1,4,6], clientClusters: [4]}
    end alt
  end loop

  note over p_discovery
  All Endpoints Discovered, Discovery Complete
  end note
  p_controller <- p_discovery: controller_callback(EUI64_X, DISCOVERY_SUCCESS)
  p_listener <- p_discovery: listener_callback(EUI64_X, DISCOVERY_SUCCESS)
end alt
@enduml

PlantUML version 1.2022.0(Tue Jan 11 16:16:42 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: ANSI_X3.4-1968
Language: en
Country: US
--></g></svg>